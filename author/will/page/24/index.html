<!DOCTYPE html>
<html lang="en-GB">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">
<link rel="stylesheet" media="print" href="/wp-content/cache/autoptimize/css/autoptimize_ad69f4871caf44872ba0f8df0a19d0dc.css" onload="this.onload=null;this.media='all';">
<noscript id="aonoscrcss"><link media="all" href="/wp-content/cache/autoptimize/css/autoptimize_ad69f4871caf44872ba0f8df0a19d0dc.css" rel="stylesheet"></noscript>
<title>will &#8211; Page 24 &#8211; whizzy.org</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Posts by will Feed" href="/author/will/feed/"> <script type="text/javascript">window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.whizzy.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);</script> <link rel="stylesheet" id="googleOpenSans-css" href="//fonts.googleapis.com/css?family=Open+Sans%3A400%2C400italic%2C600%2C700%2C700italic&#038;subset=latin%2Ccyrillic&#038;ver=5.7.2" type="text/css" media="all"> <script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.5.1" id="jquery-core-js"></script> <link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/users/1">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 5.7.2">
</head>
<body class="archive paged author author-will author-1 custom-background paged-24 author-paged-24 emmet pages-background"> <a class="skip-link screen-reader-text" href="#main"> Skip to content</a><div class="wrapper  ">
<header id="header" class="main-header"><div class="top-header"><div class="container">
<div class="top-menu">
<ul id="menu-top-menu" class="menu"></ul>
<div class="clearfix"></div>
</div>
<div class="social-profile type1 "> <a href="https://twitter.com/8none1" class="button-twitter" title="Twitter" target="_blank"><i class="fa fa-twitter-square"></i></a> <a href="https://github.com/8none1" class="button-google" title="Google +" target="_blank"><i class="fa fa-google-plus-square"></i></a> <a href="https://www.youtube.com/user/willcooke1" class="button-youtube" title="Youtube" target="_blank"><i class="fa fa-youtube-square"></i></a>
</div>
<div class="contact-info ">
<ul class=" info-list"></ul>
<div class="clearfix"></div>
</div>
</div></div>
<div class="site-header" data-sticky-menu="off"><div class="container">
<div class="site-logo"> <a class="home-link" href="/" title="whizzy.org" rel="home"><div class="site-description">
<p class="site-title ">whizzy.org</p>
<p class="site-tagline">On code and gadgets.</p>
</div> </a>
</div> <button class="menu-toggle" aria-controls="main-menu" aria-expanded="false"><span class="menu-show">Menu</span> <span class="menu-close">Close</span>  </button><div id="navbar" class="navbar"><nav id="site-navigation" class="main-navigation"><ul class="sf-menu"></ul></nav></div>
<div class="clearfix"></div>
</div></div></header><div id="main" class="site-main">
<div class="container breadcrumb-wrapper"><div class="breadcrumb breadcrumbs sp-breadcrumbs"><div class="breadcrumb-trail">
<a href="/" title="whizzy.org" rel="home" class="trail-begin">Home</a> <span class="sep"><i class="fa fa-angle-right"></i></span> <span class="trail-end">will</span>
</div></div></div>
<div class="container main-container"><div class="row clearfix">
<div class=" col-xs-12 col-sm-12 col-md-8 col-lg-8">
<article id="post-146" class="post-in-blog post post-146 type-post status-publish format-standard hentry category-google-maps category-javascript"><header class="entry-header"><h2 class="entry-title"> <a href="/2009/05/11/absolute-begineers-guide-to-google-maps-javascript-part-2/" rel="bookmark">Absolute beginners guide to Google Maps Javascript Part 2</a>
</h2></header><section class="entry entry-content"><h1 style="text-align: center;"><span style="color: #339966;">Stop!  This page is out of date.  <a title="Absolute beginners guide to Google Maps JavaScript v3" href="/2013/12/absolute-beginners-guide-to-google-maps-javascript-v3/"><span style="color: #339966;">Read this one first</span></a>.</span></h1>
<h1></h1>
<h1>Part 2. Doing a bit more with the Google Maps API</h1>
<p>This guide follows on from this one: <a title="https://www.whizzy.org/2009/05/absolute-begineers-guide-to-google-maps-javascript/" href="/2009/05/absolute-begineers-guide-to-google-maps-javascript/" target="_self" rel="noopener noreferrer">https://www.whizzy.org/2009/05/absolute-begineers-guide-to-google-maps-javascript/</a><br> You&#8217;ll need to install Firefox and the Firebug add-on: <a title="https://addons.mozilla.org/en-US/firefox/addon/1843" href="https://addons.mozilla.org/en-US/firefox/addon/1843" target="_self" rel="noopener noreferrer">https://addons.mozilla.org/en-US/firefox/addon/1843</a></p>
<p>If you&#8217;ve run through the previous guide you should have a little 27 line piece of HTML and JavaScript which gets you a basic draggable map on to your page with a marker in the centre.  It&#8217;s not much, but it was easy to do and most of all it didn&#8217;t take us very long.  Now we&#8217;re going to make the process of adding more markers to the map a bit easier, give each marker an infoWindow to display some text and see how to read some information back out of the marker object and finally we&#8217;ll give our marker a different icon to the standard red one.</p>
<ol>
<li>Create a function to add Markers</li>
<li>Giving markers an infoWindow</li>
<li>Reading information back out of the marker</li>
<li>Changing the marker icon</li>
</ol>
<h2>Part 2.1 Creating a function to add Markers</h2>
<p>Why do you need a function to add markers when you could just copy &amp; paste the line we used in part 1. Imagine you have 50 markers added to your map, they would all have different co-ordinates but they might also have some common features such as &#8220;type&#8221; which might be &#8216;Bus Stop&#8217;. What would happen if you wanted to make a change to that title for all your makers, like adding a prefix of &#8216;Marker:&#8217;? If you used the copy &amp; paste method to create the 50 markers you would have to go through each of the 50 lines and make the change, but if you used a function to create the markers and moved the common attributes to that function you would only need to make the change in one place &#8211; inside the function. By doing this we are using the DRY principal &#8211; Don&#8217;t Repeat Yourself. It will allow us to specify all common attributes only once and so therefore make changing those common attributes very quick. Our new function is called addMarker and when added to our code from part 1, the &lt;script&gt; section looks like this:</p>
<pre class="codestyle">&lt;script type="text/javascript"&gt;
  google.load("maps","2", {"other_params":"sensor=false"});
  function init() {
    map = new google.maps.Map2(document.getElementById("map"));
    var myLatLng = new google.maps.LatLng(54.124634, -3.237029);
    map.setCenter(myLatLng,17);
    map.addControl(new google.maps.LargeMapControl());
    map.addControl(new google.maps.MapTypeControl());
    map.setMapType(G_SATELLITE_MAP);
    newMarker1 = addMarker(54.124634, -3.237029,'Barrow-in-Furness Bus Depot');
    newMarker2 = addMarker(54.124500, -3.237129,'Monster defence system');
  };
  function addMarker(lat,lng,marker_title) {
    var myLatLng = new google.maps.LatLng(lat,lng);
    marker_title = 'Marker:  '+marker_title;
    var myMarkerOptions = {"draggable":true, "title":marker_title};
    var myMarker = new google.maps.Marker(myLatLng, myMarkerOptions);
    map.addOverlay(myMarker);
    return myMarker;
  };
  google.setOnLoadCallback(init);
&lt;/script&gt;</pre>
<p>You can see the new addMarker function inserted between the closing curly bracket of init() and the line google.setOnLoadCallback(init);.  The function accepts three things as shown by the comma separated values inside the brackets &#8211; lat,lng and title.  These are variables which become accessible inside the function and will be set to the values passed in when the function is called, in the same order as they are passed in.  For example, if I called the addMarker function like this:</p>
<pre class="codestyle">addMarker('blue',42,'soup');</pre>
<p>then lat would become a string &#8216;blue&#8217;,  lng would become the number 42 and title would be a string &#8216;soup&#8217;.  Obviously those values aren&#8217;t going to be valid for our real function as &#8216;blue&#8217; is not a measurement of latitude &#8211; but you get the idea.   We actually call the function from inside the init() function,  like this:</p>
<pre class="codestyle">newMarker1 = addMarker(54.124634, -3.237029,'Barrow-in-Furness Bus Depot');
newMarker2 = addMarker(54.124500, -3.237129,'Monster defence system');</pre>
<p>You can see we actually pass in a real latitude, longitude and title string.<br> Back inside the new function, the first thing we do is construct a new instance of a google.maps.LatLng class by passing it the lat and lng variables that were used when the function was called.   We assign this to a local variable called myLatLng.  Notice we use var myLatLng &#8211; this makes myLatLng local to our function, it&#8217;s not a global variable.   Next we prepend &#8216;Marker: &#8216; to the marker_title variable and then we declare another function-local variable (note the var) which is our dictionary of keywords and values mated together with a colon and separated from each other with a comma.  This also demonstrates why using a function is a better way of doing things.   On the whole marker options are likely to the same for every marker you have on your map,  so rather than specifying the same set of options for each marker we only do it once, inside the function.  If we want to change the options we just have to change one line rather than one line per marker.  If you wanted to add more options you would just add them to the end of the dictionary.  For example, let&#8217;s say you wanted to make your markers not bounce up and down when you let go after dragging.   From the API reference we can see that the option is &#8220;bouncy&#8221; and to turn it off we set it to false, so we just add that to the end:</p>
<pre class="codestyle">var myMarkerOptions = {"draggable":"true", "title":marker_title, "bouncy":false};</pre>
<p>You&#8217;ll notice that we don&#8217;t need to make &#8220;bouncy&#8221; true in order to get bouncy markers, from the API reference we can see that draggable makers are bouncy by default.</p>
<p>The next line creates a new instance of a google.maps.Marker class called myMarker and we use the variables we have defined above as constructors &#8211; myLatLng, which is an instance of a google.maps.LatLng and myMarkerOptions which is a dictionary of keywords and values.  myMarker is now a fully formed marker that can be added to the map with map.addOverlay(myMarker) where map is our instance of google.maps.Map2 &#8211; the main Google Maps class.<br> The last bit of our function is where things get a bit conceptual:</p>
<pre class="codestyle">return myMarker;</pre>
<p>When we instantiate the new marker we store a reference to it in the variable myMarker.  myMarker is not actually the object, but rather a set of directions telling us where that marker is in memory.  We can pass that reference around to tell functions which marker we are talking about when we perform actions on it,  such as adding it to the map with addOverlay.   We call addOverlay and tell it where to find the marker we have just created.  A problem arises when we call the addMarker function for a second time, as the variable myMarker stops being directions to the first marker and starts being directions to the new marker.  We have lost our directions to the first marker.  It still exists in memory, and the map knows where it is, but we don&#8217;t.  This is why we return the reference, or directions, at the end of our function &#8211; so we can keep a record of it outside of the addMarker function.  When we call the function first time around:</p>
<pre class="codestyle">newMarker1 = addMarker(54.124634, -3.237029,'Barrow-in-Furness Bus Depot');</pre>
<p>the &#8216;return myMarker;&#8217; passes the reference to the marker back out of the function and the &#8216;newMarker1 =&#8217; accepts that returned reference and becomes a reference to the marker itself.  Then, then next time we call the function:</p>
<pre class="codestyle">newMarker2 = addMarker(54.124500, -3.237129,'Monster defence system');</pre>
<p>newMarker2 becomes a reference to the second marker.</p>
<p>So there you have it.  A simple little function that makes it a bit easier to add new markers.  If you want a nice way of storing all these references and then being able to do things like loop through them &#8211; look up JavaScript arrays &#8211; but we&#8217;ll cover this in a later tutorial.  Now we&#8217;ve got our function we can start adding more features to it.</p>
<h2>Part 2.2 Adding Info Windows to your markers.</h2>
<p>An Info Window is a pop-up area inside that map that you can use to provide more information about markers.  It usually appears when you click on a marker.   There are many different types of infoWindow available with the Google Maps API, but for now we will be using an HTML infoWindow because it&#8217;s very easy to set up.  If we are going to display an infoWindow we are going to need some information to display in it, so the first thing is to extend our function to accept a fourth incoming variable which can be used to pass in the contents of the infoWindow.</p>
<pre class="codestyle">function addMarker(lat,lng,title,descr) {</pre>
<p>This gives us a new variable inside the function called &#8216;descr&#8217; which we will use as the contents of the infoWindow.  As we are using an HTML infoWindow we could pass an HTML string in to our function when we call it, something like this:</p>
<pre class="codestyle">newMarker1 = addMarker(54.124634, -3.237029,'Barrow-in-Furness Bus Depot','&lt;b&gt;Barrow-in-Furness Bus Depot&lt;/b&gt;&lt;br /&gt;Under threat from monsters');</pre>
<p>&#8230; or we could just pass in some plain text and HTMLifiy it inside the function, which is a much better idea as we can affect a global change much more easily inside the function.  So we will just use a plain string:</p>
<pre class="codestyle">newMarker1 = addMarker(54.124634, -3.237029,'Barrow-in-Furness Bus Depot', 'under threat from monsters');</pre>
<p>which means we need to add the HTML inside the function.  We will do this by associating a new variable to the marker object:</p>
<pre class="codestyle">var myMarker = new google.maps.Marker(myLatLng, myMarkerOptions);
myMarker.infoHtml = '&lt;b&gt;'+title+'&lt;/b&gt;&lt;br /&gt;'+descr</pre>
<p>the &#8216;var myMarker&#8230;&#8217; line is the same as it was above, I&#8217;ve included it here to show you where the new line appears, that is underneath the line where we instantiate myMarker.  So, after we have created our myMarker we associate a new variable with it, called infoHTML.  This is a very powerful function of JavaScript and we should explain exactly what&#8217;s happened here.  We have created a new attribute or property within the myMarker object and assigned it a value.  This property, or association, now lives with the myMarker object.  We can add lots of extra information to myMarker very easily and use our reference to get access to them in this way.   So anywhere that this marker goes, infoHtml will go with it.   You can see that our HTML is made of the title in bold, a newline and the descr tagged on the end.</p>
<p>Now we have the HTML ready for the infoWindow we need to trigger the opening of that window.  As you would expect this is triggered when you click on a marker.  The Google Maps API makes it easy for us to hook in to this &#8220;click&#8221; event and to trigger our own code:</p>
<pre class="codestyle">google.maps.Event.addListener(myMarker, "click", function() {
myMarker.openInfoWindowHtml(myMarker.infoHtml, {maxWidth: 300});
});</pre>
<p>The Map2 class has a number of events that we can listen out for.  We register our interest in a particular event by using the addListener method of Event.  We are saying that when a &#8220;click&#8221; event is generated from source myMarker (where myMarker is a reference to the marker we are adding during this call of the function) then execute this function, and then the function to be run.  That function, which is included inline, simply calls the openInfoWindowHtml method of myMarker with the infoHtml string we associated with the marker, and then the optional maxWidth keyword.</p>
<p>And that&#8217;s all there is to it.  Now you have a function to create markers with infoWindows.  The whole thing looks like this:</p>
<pre class="codestyle">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml"&gt;
  &lt;head&gt;
    &lt;meta http-equiv="content-type" content="text/html; charset=utf-8"/&gt;
    &lt;script type="text/javascript" src="http://www.google.com/jsapi?key=xxx"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
    google.load("maps","2", {"other_params":"sensor=false"});
      function init() {
        map = new google.maps.Map2(document.getElementById("map"));
        var myLatLng = new google.maps.LatLng(54.124634, -3.237029);
        map.setCenter(myLatLng,17);
        map.addControl(new google.maps.LargeMapControl());
        map.addControl(new google.maps.MapTypeControl());
        map.setMapType(G_SATELLITE_MAP);
        newMarker1 = addMarker(54.124634, -3.237029,'Barrow-in-Furness Bus Depot', 'Very tasty to monsters');
        newMarker2 = addMarker(54.124500, -3.237129,'Monster defence system', 'Chewits to deflect hungry monsters');
        };
      function addMarker(lat,lng,title,descr) {
        var myLatLng = new google.maps.LatLng(lat,lng);
        title = 'Marker:  '+title;
        var myMarkerOptions = {"draggable":true, "title":title, "bouncy":false};
        var myMarker = new google.maps.Marker(myLatLng, myMarkerOptions);
        myMarker.infoHtml = '&lt;b&gt;'+title+'&lt;/b&gt;&lt;br /&gt;'+descr
        map.addOverlay(myMarker);
        google.maps.Event.addListener(myMarker, "click", function() {
          myMarker.openInfoWindowHtml(myMarker.infoHtml, {maxWidth: 300});
          });
        return myMarker;
        };
      google.setOnLoadCallback(init);
    &lt;/script&gt;
    &lt;title&gt;My first Google Map&lt;/title&gt;
  &lt;/head&gt;
  &lt;body onunload="google.maps.Unload()"&gt;
    &lt;div id="map" style="width: 800px; height: 800px; margin: auto; background-color: red"&gt;
      This is where the map will soon appear.
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
<h2>Part 2.3 Reading information back out of the marker.</h2>
<p>Since our markers are draggable it would be useful to know where they have been moved to. We need somewhere to display that information and a means of reading the co-ordinates from the marker. Of course, this is made easy with the Google Maps API! First of all we&#8217;ll add a couple of text input areas to the HTML to use as somewhere to display the co-ordinates after a marker has been moved:</p>
<pre class="codestyle">&lt;div id="output"&gt;
  &lt;label for="lat"&gt;Latitude:&lt;/label&gt;&lt;input id="lat" type="text" value="Unknown" &gt;
  &lt;label for="lng"&gt;Longitude:&lt;/label&gt;&lt;input id="lng" type="text" value="Unknown" &gt;
&lt;/div&gt;</pre>
<p>Using text input boxes makes it easy to copy &amp; paste the results.<br> Then we need a new function to read the information out of the marker. As before, the API provides a nice easy way for us to hook in, an event is generated when a marker has been dragged and then stops being dragged, called dragend (http://code.google.com/apis/maps/documentation/reference.html#GMarker.dragend). We add a listener to this event:</p>
<pre class="codestyle">google.maps.Event.addListener(myMarker, "dragend", function() {
  var lat_box = document.getElementById("lat");
  var lng_box = document.getElementById("lng");
  var coords = this.getLatLng();
  lat_box.value = coords.lat();
  lng_box.value = coords.lng();
});</pre>
<p>The structure of this section of our function is very similar to the infoWindow bit. We are adding a listener to the marker object that gets triggered when the dragend event is fired. This listener becomes part of the marker object referred to by myMarker. It works like this: the dragend event is fired when you release the mouse button having moved the marker, which in turns executes in inline function. We use &#8220;document.getElementById&#8221; and pass in the ID of the element to get a reference to elements in the DOM where we are going to write our output. Then we read the co-ordinates from the marker object and put them in the variable &#8220;coords&#8221;. To do this we refer to &#8220;this&#8221;. &#8220;this&#8221; is a special keyword in JavaScript, it refers to the owner of the function. So in our function, which is inline with the addListener method, the owner is set the marker itself, and the marker has a method getLatLng which returns a google.maps.LatLng, which in turn has a lat method and lng method.<br> We combine all these things to set the contents of the two text boxes to be the latitude and longitude of the marker that was dragged.</p>
<h2>Part 2.4 Using your own icon</h2>
<p>By default the Google Maps API provides you with nice red marker icon, which is fine for most maps.  On my Potton Online website I needed to be able to show lots of different types of marker on one map (see <a title="http://www.pottononline.net/map/" href="http://www.pottononline.net/map/">http://www.pottononline.net/map/</a>).  The most user-friendly way of doing this was to make each type of marker have it&#8217;s own icon.  You won&#8217;t be surprised to hear that one of the options available when creating a new instance of a marker is &#8220;icon&#8221;.  This &#8220;icon&#8221; option needs to be a google.maps.Icon class, which has a number of properties that define the icon to be used. Unfortunetly it&#8217;s not just a case of saying &#8220;Use this image to be the icon&#8221;, but it&#8217;s not a lot more complicated.   We will create a function to create these google.maps.Icon instances and we will modify the addMarker function to accept these Icons so that the google.maps.Marker construction can use it.<br> The new function to spit out google.maps.Icon instances looks like this:</p>
<pre class="codestyle">function createIcon(iconUrl, shadowUrl) {
  var myIcon = new google.maps.Icon();
  myIcon.image = iconUrl;
  myIcon.shadow = shadowUrl;
  myIcon.size = new google.maps.Size(32,32);
  myIcon.shadowsize = new google.maps.Size(59,32);
  myIcon.iconAnchor = new google.maps.Point(16,32);
  myIcon.infoWindowAnchor = new google.maps.Point(16,0);
  return myIcon;
};</pre>
<p>I hope that you&#8217;ll be able to look at this function and have a rough idea how it works.   But let&#8217;s run through it anyway.  The function accepts two inputs;  iconUrl and shadowUrl.  The icons on a map can have a shadow to give the impression that are standing up vertically from the map.   This shadow is just an image with some clever stretching performed on it.  The first thing we do is create a new empty instance of google.maps.Icon.  We see from the API reference there are no required constructors,  so we won&#8217;t use any.  A google.maps.Icon has a number of properties, some of which are required, some of which aren&#8217;t.   It isn&#8217;t immediately apparent to me which is which, so through trial and error I came up with this list.  For now, just belive me.  The first property is image.  Fairly obviously this is required, and it&#8217;s a URL to a location where the image can be found.   The same goes for shadow.   size and shadowsize describe the size in pixels of the image and its associated shadow.  These are of the type google.maps.Size which is just an x,y pair of numbers.  We&#8217;re including them inline to save on typing.  The iconAnchor and infoWindowAnchor are similar to the size properties.   These describe a point on the icon where the it is anchored to the window and the infoWindow.   These are also a special type, this time called Point.  The last line returns the bundle of properties called myIcon back to the place where the function was called from.  To call this function we use a line like this:</p>
<pre class="codestyle">var icon = createIcon('http://maps.google.com/mapfiles/ms/micons/bus.png', 'http://maps.google.com/mapfiles/ms/micons/bus.shadow.png');</pre>
<p>So &#8220;icon&#8221; now becomes an instance of google.maps.Icon and can be used when we instantiate our marker.  This is done by passing the variable &#8220;icon&#8221; in to the addMarker function.  When we call addMarker now, the line would look like this:</p>
<pre class="codestyle">newMarker1 = addMarker(54.124634, -3.237029,'Barrow-in-Furness Bus Depot', 'Very tasty to monsters', icon);</pre>
<p>You can see we&#8217;ve just tagged &#8220;icon&#8221; on the end of the data we are passing in to addMarker.   Of course, this means that we need to modify the addMarker function to accept this extra information.   So the whole addMarker function now looks like this:</p>
<pre class="codestyle">function addMarker(lat,lng,title,descr,icon) {
  var myLatLng = new google.maps.LatLng(lat,lng);
  title = 'Marker:  '+title;
  var myMarkerOptions = {"draggable":true, "title":title, "bouncy":false, "icon":icon};
  var myMarker = new google.maps.Marker(myLatLng, myMarkerOptions);
  myMarker.infoHtml = '&lt;b&gt;'+title+'&lt;/b&gt;&lt;br /&gt;'+descr
  map.addOverlay(myMarker);
  google.maps.Event.addListener(myMarker, "click", function() {
    myMarker.openInfoWindowHtml(myMarker.infoHtml, {maxWidth: 300});
    });
  google.maps.Event.addListener(myMarker, "dragend", function() {
    var lat_box = document.getElementById("lat");
    var lng_box = document.getElementById("lng");
    var coords = this.getLatLng();
    lat_box.value = coords.lat();
    lng_box.value = coords.lng();
    });
return myMarker;
};</pre>
<p>The changes are on the first line, where we add &#8216;icon&#8217; to the list of function inputs and we add another keyword to the myMarkerOptions line &#8220;icon&#8221; and the value icon which is the google.maps.Icon class we passed in when we called the function.  And that&#8217;s it!  Now your marker has an icon, which has it&#8217;s source as a URL to an image on the internet.</p>
<p>If we combine all these steps from Part 1 and Part 2 our entire HTML file now looks like this:</p>
<pre class="codestyle">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml"&gt;
  &lt;head&gt;
    &lt;meta http-equiv="content-type" content="text/html; charset=utf-8"/&gt;
    &lt;script type="text/javascript" src="http://www.google.com/jsapi?key=xxx"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
      google.load("maps","2", {"other_params":"sensor=false"});
      function init() {
        map = new google.maps.Map2(document.getElementById("map"));
        var myLatLng = new google.maps.LatLng(54.124634, -3.237029);
        map.setCenter(myLatLng,17);
        map.addControl(new google.maps.LargeMapControl());
        map.addControl(new google.maps.MapTypeControl());
        map.setMapType(G_SATELLITE_MAP);
        var icon = createIcon('http://maps.google.com/mapfiles/ms/micons/bus.png', 'http://maps.google.com/mapfiles/ms/micons/bus.shadow.png');
        newMarker1 = addMarker(54.124634, -3.237029,'Barrow-in-Furness Bus Depot', 'Very tasty to monsters', icon);
        var icon = createIcon('http://maps.google.com/mapfiles/ms/micons/snack_bar.png','http://maps.google.com/mapfiles/ms/micons/snack_bar.shadow.png');
        newMarker2 = addMarker(54.124500, -3.237129,'Monster defence system', 'Chewits to deflect hungry monsters', icon);
        };
      function addMarker(lat,lng,title,descr,icon) {
        var myLatLng = new google.maps.LatLng(lat,lng);
        title = 'Marker:  '+title;
        var myMarkerOptions = {"draggable":true, "title":title, "bouncy":false, "icon":icon};
        var myMarker = new google.maps.Marker(myLatLng, myMarkerOptions);
        myMarker.infoHtml = '&lt;b&gt;'+title+'&lt;/b&gt;&lt;br /&gt;'+descr
        map.addOverlay(myMarker);
        google.maps.Event.addListener(myMarker, "click", function() {
          myMarker.openInfoWindowHtml(myMarker.infoHtml, {maxWidth: 300});
          });
        google.maps.Event.addListener(myMarker, "dragend", function() {
          var lat_box = document.getElementById("lat");
          var lng_box = document.getElementById("lng");
          var coords = this.getLatLng();
          lat_box.value = coords.lat();
          lng_box.value = coords.lng();
          });
        return myMarker;
        };
      function createIcon(iconUrl, shadowUrl) {
        var myIcon = new google.maps.Icon();
        myIcon.image = iconUrl;
        myIcon.shadow = shadowUrl;
        myIcon.size = new google.maps.Size(32,32);
        myIcon.shadowsize = new google.maps.Size(59,32);
        myIcon.iconAnchor = new google.maps.Point(16,32);
        myIcon.infoWindowAnchor = new google.maps.Point(16,0);
        return myIcon;
        };
      google.setOnLoadCallback(init);
    &lt;/script&gt;
    &lt;title&gt;My first Google Map&lt;/title&gt;
  &lt;/head&gt;
  &lt;body onunload="google.maps.Unload()"&gt;
    &lt;div id="map" style="width: 800px; height: 800px; margin: auto; background-color: red"&gt;
      This is where the map will soon appear.
    &lt;/div&gt;
    &lt;div id="output"&gt;
      &lt;label for="lat"&gt;Latitude:&lt;/label&gt;&lt;input id="lat" type="text" value="Unknown" &gt;
      &lt;label for="lng"&gt;Longitude:&lt;/label&gt;&lt;input id="lng" type="text" value="Unknown" &gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
<p>At first glance that might look quite scary, but it&#8217;s really not that bad.  You should be able to read through the script section and understand how it works.</p>
<h2>Additional</h2>
<p>Hopefully you have installed the Firefox add-in called Firebug. If you have you can play around with the Google Maps API from the Javascript console built in to Firebug. Click on the little bug icon in the bottom left of the browser window and make sure the the console is enabled. Then you will see the console input area as shown by &#8220;&gt;&gt;&gt;&#8221; at the bottom of the screen. In to this section type:</p>
<pre class="codestyle">newMarker1.hide();</pre>
<p>and then</p>
<pre class="codestyle">newMarker1.show();</pre>
<p>Now you got something else to play with. You could use this to show only markers of a particular type. We&#8217;ll cover this next time.</p>
<div class="clearfix"></div></section><footer class="entry-footer"><div class="meta"> <span class="author">Posted by </span><a href="/author/will/" title="Posts by will" rel="author">will</a> <span class="seporator">/</span> <span class="date-post h6">May 11, 2009</span> <span class="seporator">/</span> <span>Posted in</span> <a href="/category/google-maps/" rel="category tag">Google Maps</a><span>,</span> <a href="/category/javascript/" rel="category tag">Javascript</a>
</div></footer></article><article id="post-6" class="post-in-blog post post-6 type-post status-publish format-standard hentry category-google-maps category-javascript"><header class="entry-header"><h2 class="entry-title"> <a href="/2009/05/08/absolute-beginners-guide-to-google-maps-javascript/" rel="bookmark">Absolute beginners guide to Google Maps Javascript</a>
</h2></header><section class="entry entry-content"><h1 style="text-align: center;"><span style="color: #339966;">STOP!  This page is quite out of date!  <a title="Absolute beginners guide to Google Maps JavaScript v3" href="/2013/12/absolute-beginners-guide-to-google-maps-javascript-v3/"><span style="text-decoration: underline;">Click here to read an up-to-date version</span></a>.</span></h1>
<p style="text-align: justify;">So &#8211; you&#8217;ve got an idea for site that makes use of the Google Maps API but you lack any knowledge of Javascript whatsoever &#8211; where do you start?  Up until about 6 months ago I didn&#8217;t know, so I went about learning how and now I&#8217;m going to write it up in to a tutorial so you can find out too.  This guide is aimed at beginners of Javascript and DOM scripting, some knowledge of HTML is assumed.  We will assume that you are running the HTML from your local computer to start with, before uploading it to a server.  I would recommend that if you use Firefox, that you install the Firebug addon:  <a href="https://addons.mozilla.org/en-US/firefox/addon/1843">https://addons.mozilla.org/en-US/firefox/addon/1843</a>  Chromium comes with the same functionality built in, just hit f12.</p>
<h3>Part 1.  Getting that draggable map on to your web page.</h3>
<p style="text-align: justify;">The Google maps API really does a lot to make it easy to get the map to appear on your page, but you need to lay a few of the foundations first.  The steps involved in getting the map on to your page are:</p>
<ol style="text-align: justify;">
<li>Getting a Google Maps API key</li>
<li>Creating a correctly formatted HTML page</li>
<li>Loading the necessary JavaScript libraries</li>
<li>Writing your own JavaScript code to get the map to actually appear</li>
<li>A bit more code to make the map into something useful</li>
</ol>
<p style="text-align: justify;">All of the above should be achievable in about 60 minutes.</p>
<h4>
<span style="text-decoration: underline;">P</span><span style="text-decoration: underline;">art 1.1  Getting a Google Maps API key</span>
</h4>
<p style="text-align: justify;">Nice and easy.  Go to:</p>
<p><a href="https://developers.google.com/maps/documentation/javascript/tutorial#api_key" target="_blank" rel="noopener noreferrer">https://developers.google.com/maps/documentation/javascript/tutorial#api_key</a> (opens in a new window)</p>
<p style="text-align: justify;">and follow the instructions.</p>
<p>While you don&#8217;t actually <strong>need</strong> an API key, it will help you to track usage and if your map page hits the big time you&#8217;ll already be set up.</p>
<p><span style="text-align: justify;">Got your API key?  Good, let&#8217;s carry on.</span></p>
<h4>Part 1.2  Writing the basic HTML</h4>
<p style="text-align: justify;">The best thing about standard HTML is that there is so much variety.  In order to try and guarantee a consistent layout across browsers you need to make sure that your page  is rendered in &#8216;Standards Compliant&#8217; mode as opposed to &#8216;Quirks&#8217; mode.  To do this you need to specify a DOCTYPE at the top of your HTML file.  Google recommends that you use this XHTML DOCTYPE:</p>
<pre class="codestyle">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</pre>
<p>so your HTML file should have that line right at the top.  Hand in hand with this goes an &#8216;xmlns&#8217; attribute on the &lt;html&gt; element in the page, like this:</p>
<pre class="codestyle">&lt;html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml"&gt;</pre>
<p>We are using this particular line because we might want to make use of the PolyLine features of Google Maps in the future.  More on this in a later guide, for now just believe me.</p>
<p>It&#8217;s also important to specify the correct character encoding.  Google Maps by default uses UTF-8 and you should do the same unless you have a reason not to.  This is the example given by Google:</p>
<pre class="codestyle">&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"/&gt;</pre>
<p>but this goes<em> inside</em> the HTML head area.</p>
<p>If we put all these together in to a very basic HTML file it would look something like this:</p>
<pre class="codestyle">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml"&gt;
  &lt;head&gt;
    &lt;meta http-equiv="content-type" content="text/html; charset=utf-8"/&gt;
    &lt;title&gt;My first Google Map&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div id="map" style="width: 800px; height: 800px; margin: auto; background-color: red"&gt;
      This is where the map will soon appear.
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
<p>Copy and paste this in to a text editor and then save that file as something like &#8216;maps.html&#8217; and open it in your browser. You won&#8217;t be amazed to see an 800 x 800 pixel red box in the middle of the screen. But the really important thing is that this is <span style="text-decoration: underline;">valid XHTML</span> meaning the browser will render it in &#8216;standards compliant&#8217; mode.</p>
<p>So far so good. You&#8217;ve got a Google Maps API key and now you&#8217;ve got an area on the page in which the maps can be displayed, now you just need get that map on to the page.</p>
<h4><span style="text-decoration: underline;"><strong>Part 1.3  Loading the Javascript libraries</strong></span></h4>
<p>Google to the rescue. They host a set of <a href="http://en.wikipedia.org/wiki/Ajax_(programming)">AJAX</a> APIs that we can use to do some really clever tricks, but first we need to use the loader to get access to them. This is simply a case of loading the Google AJAX API Loader with this line inside the &lt;head&gt; section of the HTML page:</p>
<pre class="codestyle">&lt;head&gt;
  ...
    &lt;script type="text/javascript" src="http://www.google.com/jsapi?key=XXXXXXXXXXXX"&gt;&lt;/script&gt;
  ...
&lt;/head&gt;</pre>
<p>where &#8216;XXXXXXXXX&#8217; should be your API key.<br> This loads the Google loader, which we can then use to load the Google Maps API (and in the future any other Google hosted APIs such as jQuery which we&#8217;ll get to another day). Again, this code is located in the &lt;head&gt; section of the HTML, below the line that loads the Google loader. So, now our &lt;head&gt; section looks like this:</p>
<pre class="codestyle">&lt;head&gt;
  ...
    &lt;script type="text/javascript" src="http://www.google.com/jsapi?key=XXXXXXXXXXXX"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
      google.load("maps","2", {"other_params":"sensor=false"});
    &lt;/script&gt;
  ...
&lt;/head&gt;</pre>
<p>What&#8217;s just happened here, is that you&#8217;ve just written a line of Javascript!  It&#8217;s not a very long or complicated line but it opens up a world of Javascript wonder to us.  There are six things we should mention about that one little line:</p>
<ol>
<li>Javascript inside an HTML file must be surrounded by <span style="font-family: 'Courier New'; line-height: 18px; white-space: pre;">&lt;script&gt; <span style="font-family: Georgia; line-height: 19px; white-space: normal;">tags.  To make sure it&#8217;s a valid tag the opening one must say what sort of thing is inside.  In our case <span style="font-family: 'Courier New'; line-height: 18px; white-space: pre;">&#8216;text/javascript&#8217;</span></span></span>
</li>
<li>The <span style="font-family: 'Courier New'; line-height: 18px; white-space: pre;">&#8216;google.&#8217; <span style="font-family: Georgia; line-height: 19px; white-space: normal;">bit becomes available after we loaded <span style="font-family: 'Courier New'; line-height: 18px; white-space: pre;">jsapi <span style="font-family: Georgia; line-height: 19px; white-space: normal;">from www.google.com at the start of this section.  This is referred to as the google namespace. </span></span></span></span>
</li>
<li>The google namespace has many methods.  One of these methods is <span style="font-family: 'Courier New'; line-height: 18px; white-space: pre;">&#8216;load&#8217; <span style="font-family: Georgia; line-height: 19px; white-space: normal;">which is separated from the &#8216;google&#8217; bit with a &#8216;.&#8217; and accepts a few arguments. </span></span>
</li>
<li>The arguments are passed inside the brackets.  In our case we are passing the arguments &#8216;maps&#8217; and &#8216;2&#8217;.  &#8216;maps&#8217; is the API we want to load, and &#8216;2&#8217; is the version.  Version 2 is a bit of a generic version number and actual version number that represents &#8216;2&#8217; changes frequently.  For example, at the moment 2 represents version 2.97</li>
<li>We also have to tell Google that we&#8217;re not using a sensor (e.g. GPS) to determine user location.  I don&#8217;t know why this should matter, but Google say you must tell them, so tell them we will.  This is a sort of dictionary where we link keywords with values.  In this case the keyword is &#8216;other_params&#8217; and the value is &#8216;sensor=false&#8217;.</li>
<li>The line ends with a semicolon.  You may see Javascript written where semicolons don&#8217;t appear at the end of a line.  Some browsers are smart enough to realise that a new line represents the end of a line of code, others are not.  So for now just always stick a semicolon on the end of a line, except where you are closing a curly bracket and then immediately closing a normal bracket.</li>
</ol>
<p>Add these two script elements to your HTML file in the &lt;head&gt; section, below the meta tag and above the title, and reload the page.  If you&#8217;ve done it correctly you won&#8217;t notice any difference and Firebug should show no errors.</p>
<h4><span style="text-decoration: underline;">Part 1.4  Making the map appear</span></h4>
<p>Now we&#8217;re going to write the code to make the basic map appear on your page, in 5 extra lines.</p>
<pre class="codestyle">...
&lt;script type="text/javascript"&gt;
  google.load("maps","2", {"other_params":"sensor=false"});
  function init() {
    map = new google.maps.Map2(document.getElementById("map"));
    map.setCenter(new google.maps.LatLng(54.124634, -3.237029),17);
  };
  google.setOnLoadCallback(init);
&lt;/script&gt;
...</pre>
<p>These extra lines of code go between the same &lt;script&gt; tags as the line we used to load the the Google Maps API and must come after the google.load line otherwise the google.maps namespace won&#8217;t exist.  First we create a new function called init.  As you&#8217;d expect &#8211; the function won&#8217;t do anything until it&#8217;s called, we&#8217;re just creating it so we can use it in a minute.  The function doesn&#8217;t take any arguments, hence the empty set of brackets.  The actual code inside the function lives between two curly brackets { } and of course each line ends with a semicolon.</p>
<p>First we declare a variable called map.  Notice that we don&#8217;t say &#8216;<strong>var</strong> map = new google.maps.Map2&#8230;.&#8217;.  If we did use var then our &#8216;map&#8217; would only be accessible from within the function that declared it (init in our case).  Since we are going to access the map from many other functions we&#8217;ll create &#8216;map&#8217; as a global variable by not using var.</p>
<p>The variable &#8216;map&#8217; becomes a new instance of the class &#8216;Map2&#8217; from within the google.maps namespace.  The Map2 class takes a &#8216;constructor&#8217; which specifies the node within the document that will be used to display the map.  In our case, as is most common, that node is a div element.  We pass the getElementById function the Id of our div and it returns a reference that we can then pass to Map2 as the required constructor.</p>
<p>Or, put differently, &#8216;map&#8217; becomes a new copy of a thing called Map2 which Google have provided for us.  The new copy needs to know where to put the map, so we tell it which div we want to use.</p>
<p>Now our variable &#8216;map&#8217; has been constructed it is an object of class Map2 and as such it posses certain predefined &#8216;methods&#8217; and &#8216;events&#8217;.  A methods is a way of doing things, and events happen.  These are already in place and all we have to do is either tell them what to do, or listen to what they have to say.</p>
<p>The first method we make use of is setCenter (note the spelling Euro people).  Unsurprisingly the setCenter method sets the centre point for the map.  It takes as an argument a special Google LatLng object.  How do I know this you ask?  Everything you need to know about the Google Maps API can be found here  (centred on the setCenter method):  <a href="http://code.google.com/apis/maps/documentation/reference.html#GMap2.setCenter" target="_blank" rel="noopener noreferrer">http://code.google.com/apis/maps/documentation/reference.html#GMap2.setCenter</a></p>
<p>(You need to be aware that the API refers to the original G namespace, not the google.maps namespace. So in the API wherever you see a capital G in front of something, you can probably assume you should drop the G and replace it with &#8216;google.maps.&#8217;  You can argue that we should stick to using the G namespace since that&#8217;s what the docs are written in, but the conversion is really easy, and I expect that all new API docs will use the full google namespace.  <strong>UPDATE:</strong>  Google have announced that indeed everything will be moving to the google namespace in the future.  <a href="http://googlegeodevelopers.blogspot.com/2009/05/announcing-google-maps-api-v3.html">http://googlegeodevelopers.blogspot.com/2009/05/announcing-google-maps-api-v3.html</a>)</p>
<p>From the API reference you can see the method also accepts an optional (note the &#8216;?&#8217; in the API reference) zoom and type.  Since it is optional will ignore the type for now, and only pass a LatLng object and a zoom level.  It&#8217;s easy to create our LatLng object, we just instanciate (create) a new google.maps.LatLng class with the latitude and longitude passed to it as numbers.  You can see we do all of this inline, we could equally have declared a new variable, this time with the var prefix, like this:</p>
<pre class="codestyle">var myLatLng = new google.maps.LatLng(54.124634, -3.237029);</pre>
<p>and then passed that to setCenter instead:</p>
<pre class="codestyle">map.setCenter(myLatLng,17);</pre>
<p>As you&#8217;ve probably already worked out the &#8217;17&#8217; is the optional zoom value.</p>
<p>Notice we close the function with another close-curly-brackets and a semicolon on a new line with the same indention as the line where we started the function, and the contents of the function indented from there.</p>
<p>The last of our Javascript lines causes our init function to get called and make the map appear.  When you are working with elements in the page, for example a div with and Id of &#8216;map&#8217;, using Javascript you are interacting with the DOM, Document Object Model.  This is the browsers internal table of what makes up the web page you are looking at and it gets created as the HTML source loads.  If you&#8217;re at the end of a particularly slow internet connection, say a mobile phone, and the page you are loading is quite large it could take a minute or two before all the HTML is loaded.  Before all the HTML is loaded the browser can&#8217;t finish building the DOM.  If you tried to reference an element in on the page  before it had loaded you would get an error something along the lines of &#8220;the element your are referring is undefined&#8221;.  To combat this the browser can tell you when the DOM is ready for you to use and to make things even easier the Google loader provides a nice easy way for you to call your functions when the DOM is ready.</p>
<p>From the google namespace we have a method called setOnLoadCallback which takes a function as an argument.  So we pass it our function called init, and sit back and relax as the browser loads the source, gets the DOM ready, signals that the DOM is ready, the onLoadCallback method gets triggered and in turn calls our init() function which replaces the div called map with a draggable Google Map.  So add the above few lines in to your HTML and reload your browser.  If you&#8217;ve done it right you should see a map!</p>
<p>In 21 lines of text we&#8217;ve created a Google map in the middle of our page.  It&#8217;s pretty basic, in that we can only drag it about and double click to zoom in or double right click to zoom out, but consider how little we had to do to make it work.</p>
<h4><span style="text-decoration: underline;">Part 1.5  Doing a bit more with the map</span></h4>
<p>We&#8217;ve got a map, but it&#8217;s missing a few key parts like the zoom slider and the buttons to switch between the different map types and a marker indicating a point on the map.</p>
<p>Remember how we could have created a variable to hold our google.maps.LatLng object, but that we didn&#8217;t need to?  Well, now we&#8217;re going to need to reference that LatLng in a couple of places, so it makes sense to keep it in a variable, just to save a bit of typing.  To do this we&#8217;re going to rewrite the init() function.  The new function looks like this:</p>
<pre class="codestyle">function init() {
  map = new google.maps.Map2(document.getElementById("map"));
  var myLatLng = new google.maps.LatLng(54.124634, -3.237029);
  map.setCenter(myLatLng,17);
  var myMarker = new google.maps.Marker(myLatLng, {"draggable":"true","title":"A place on earth"});
  map.addControl(new google.maps.LargeMapControl());
  map.addControl(new google.maps.MapTypeControl());
  map.setMapType(G_SATELLITE_MAP);
  map.addOverlay(myMarker);
};</pre>
<p>The way we create the map object stays the same, we create a new instance of class google.maps.Map2 and tell it which div we want to use to display the map.  The next line declares our new myLatLng variable which will be local to the init function because we use &#8216;var myLatLng&#8230;.&#8217; and then we set the centre of the map using our myLatLng variable and set the zoom level to 17.</p>
<p>Next we declare another new variable called myMarker.  This is a new instance of class google.maps.Marker, and to instantiate it we need to pass it a location in google.maps.LatLng format as per the map centre and some additional options.  Since we have used the same LatLng object for the Marker as we did for the setCenter the Marker will appear in the middle of the map.  Again, all of this information is found in the API reference:</p>
<p><a href="http://code.google.com/apis/maps/documentation/reference.html#GMarker" target="_blank" rel="noopener noreferrer">http://code.google.com/apis/maps/documentation/reference.html#GMarker</a></p>
<p>where we can see that the options are listed under GMarkerOptions.  These options are passed to Marker in the dictionary style format we have seen before, that is &#8211; enclosed in curly brackets we have pairs of keywords and values.  The keywords and values are separated by a colon, and each pair is separated from the next with a comma.  In our example we are only passing two options:</p>
<pre class="codestyle">{"draggable":"true","title":"A place on earth"}</pre>
<p>If we wanted to add another option, say &#8220;bouncy&#8221; we&#8217;d just add it to the end:</p>
<pre class="codestyle">{"draggable":True","title":"A place on earth","bouncy":"true"}</pre>
<p>If you read the API reference you&#8217;ll see that we don&#8217;t need to pass &#8220;bouncy&#8221;:&#8221;true&#8221; though, as any marker that is &#8220;draggable&#8221; is also &#8220;bouncy&#8221; by default, but if you wanted to turn off &#8220;bouncy&#8221; you could say that &#8220;bouncy&#8221;:&#8221;false&#8221;.</p>
<p>We&#8217;ve now created our Marker object, but we haven&#8217;t added it to the map yet.  First of all though we add the zoom slider with directional buttons and the buttons to allow us to switch between the various map types (see the API reference under &#8216;GMapType&#8217; &#8211; &#8216;Constants&#8217; for the various types available).  To add these controls to our map we use the addControl() method of a google.maps.Map2 class, in our case the variable &#8216;map&#8217;.  From the API we see that the addControl method has a constructor which requires a GControl object and an optional position.  If we then look up the GControl object in the API reference we see that it too requires constructing (that is, it is not a constant &#8211; it must be summoned from somewhere before we use it).  The API shows that the GControl class constructors don&#8217;t require any further information in order to be created &#8211; as shown by the empty set of brackets, so to instantiate (summon) a GControl object we just create a &#8216;new&#8217; one:</p>
<pre class="codestyle">new google.maps.LargeMapControl()</pre>
<p>will do that for us.  Remember if something in the API starts with an uppercase G we replace that G for &#8216;google.maps.&#8217; (note the trailing dot).  Since the addControl method requires this new instance of a GControl class as a constructor we just pass it straight in:</p>
<pre class="codestyle">map.addControl(new google.maps.LargeControl());</pre>
<p>We could equally say:</p>
<pre class="codestyle">var myLargeControl = new google.maps.LargeControl();
map.addControl(myLargeControl);</pre>
<p>but MyLargeControl just sounds too rude.</p>
<p>We repeat this process to add the controls to switch between map types:</p>
<pre class="codestyle">map.addControl(new google.maps.mapTypeControl());</pre>
<p>Next we change the default map type to the satellite view instead of the default map which only shows roads.  We use the setMapType method of a google.maps.Map2 class (our variable map).  From the API we see that setMapType requires a GMapType.  We don&#8217;t know what a GMapType is, so we click on the link in the API which takes us here:</p>
<p><a href="http://code.google.com/apis/maps/documentation/reference.html#GMapType">http://code.google.com/apis/maps/documentation/reference.html#GMapType</a></p>
<p>and have a quick read.  Straight away it says that Google have provided some predefined map types, so scroll down to &#8220;Constants&#8221; and you can see a list of these predefined map types.  We&#8217;re going to use the G_SATELLITE_MAP type and because it&#8217;s a constant we can just refer directly to it:</p>
<pre class="codestyle">map.setMapType(G_SATELLITE_MAP);</pre>
<p>Then last of all we add the marker we created earlier to the map:</p>
<pre class="codestyle">map.addOverlay(myMarker);</pre>
<p>addOverlay() is a method of google.maps.Map2 and accepts the marker as an overlay to add.  Each marker on the map is an overlay.</p>
<p>And there you have it.  A map on your web page in only 27 lines including the HTML itself.  The final HTML file looks like this:</p>
<pre class="codestyle">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml"&gt;
&lt;head&gt;
  &lt;meta http-equiv="content-type" content="text/html; charset=utf-8"/&gt;
  &lt;script type="text/javascript" src="http://www.google.com/jsapi?key=xxx"&gt;&lt;/script&gt;
  &lt;script type="text/javascript"&gt;
    google.load("maps","2", {"other_params":"sensor=false"});
    function init() {
      map = new google.maps.Map2(document.getElementById("map"));
      var myLatLng = new google.maps.LatLng(54.124634, -3.237029);
      var myMarker = new google.maps.Marker(myLatLng, {"draggable":"true","title":"A place on earth"});
      map.setCenter(myLatLng,17);
      map.addControl(new google.maps.LargeMapControl());
      map.addControl(new google.maps.MapTypeControl());
      map.setMapType(G_SATELLITE_MAP);
      map.addOverlay(myMarker);
    };
    google.setOnLoadCallback(init);
  &lt;/script&gt;
  &lt;title&gt;My first Google Map&lt;/title&gt;
&lt;/head&gt;
&lt;body onunload="google.maps.Unload()"&gt;
  &lt;div id="map" style="width: 800px; height: 800px; margin: auto; background-color: red"&gt;
    This is where the map will soon appear.
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p>Note &#8211; we have slightly modified the &lt;body&gt; to include an additional method from the google.maps namespace.  This function ensures that when you close the browser window containing your map everything is tidied up.  This prevents memory leaks in browsers such as IE6.  You should always include this in your code when you are using Google Maps.</p>
<p>Challenge 1.  As a bit of fun, why not try to add one of these to the map:</p>
<p><a href="http://code.google.com/apis/maps/documentation/reference.html#GControlImpl.GOverviewMapControl">http://code.google.com/apis/maps/documentation/reference.html#GControlImpl.GOverviewMapControl</a></p>
<p>Challenge 2.  See if you can trim the code by one line and increase the available map types at the same time:</p>
<p><a href="http://code.google.com/apis/maps/documentation/reference.html#GMap2.setUIToDefault" target="_blank" rel="noopener noreferrer">http://code.google.com/apis/maps/documentation/reference.html#GMap2.setUIToDefault</a></p>
<h2>Coming in Part 2&#8230;</h2>
<p>In part two we&#8217;ll cover more things you can do with markers such as:</p>
<ul>
<li>Create a function to add markers to the map.</li>
<li>Giving markers pop-up info windows containg text</li>
<li>Reading information back out of the marker</li>
</ul>
<h2>Useful References</h2>
<p><a title="Google Maps API Concepts" href="http://code.google.com/apis/maps/documentation/" target="_blank" rel="noopener noreferrer">Google Maps API Concepts<br> http://code.google.com/apis/maps/documentation/</a></p>
<p><a title="API Reference" href="http://code.google.com/apis/maps/documentation/reference.html" target="_blank" rel="noopener noreferrer">Google Maps API Reference<br> http://code.google.com/apis/maps/documentation/reference.html</a></p>
<p><a title="Great examples of Google Maps" href="http://code.google.com/apis/maps/documentation/examples/index.html" target="_blank" rel="noopener noreferrer">Google Maps Examples<br> http://code.google.com/apis/maps/documentation/examples/index.html</a></p>
<div class="clearfix"></div></section><footer class="entry-footer"><div class="meta"> <span class="author">Posted by </span><a href="/author/will/" title="Posts by will" rel="author">will</a> <span class="seporator">/</span> <span class="date-post h6">May 8, 2009</span> <span class="seporator">/</span> <span>Posted in</span> <a href="/category/google-maps/" rel="category tag">Google Maps</a><span>,</span> <a href="/category/javascript/" rel="category tag">Javascript</a>
</div></footer></article><nav class="navigation paging-navigation"> <a class="prev page-numbers" href="/author/will/page/23/">&laquo; Previous</a> <a class="page-numbers" href="/author/will/">1</a> <span class="page-numbers dots">&hellip;</span> <a class="page-numbers" href="/author/will/page/22/">22</a> <a class="page-numbers" href="/author/will/page/23/">23</a> <span aria-current="page" class="page-numbers current">24</span></nav>
</div>
<div class=" col-xs-12 col-sm-12 col-md-4 col-lg-4"><aside id="sidebar"><div class="widget-area">
<div id="archives-4" class="widget widget_archive">
<h3 class="widget-title">Archives</h3>
<ul>
<li><a href="/2021/01/">January 2021</a></li>
<li><a href="/2019/07/">July 2019</a></li>
<li><a href="/2019/06/">June 2019</a></li>
<li><a href="/2019/05/">May 2019</a></li>
<li><a href="/2017/05/">May 2017</a></li>
<li><a href="/2017/03/">March 2017</a></li>
<li><a href="/2017/02/">February 2017</a></li>
<li><a href="/2016/12/">December 2016</a></li>
<li><a href="/2016/11/">November 2016</a></li>
<li><a href="/2016/10/">October 2016</a></li>
<li><a href="/2016/09/">September 2016</a></li>
<li><a href="/2016/02/">February 2016</a></li>
<li><a href="/2015/12/">December 2015</a></li>
<li><a href="/2015/10/">October 2015</a></li>
<li><a href="/2015/09/">September 2015</a></li>
<li><a href="/2015/06/">June 2015</a></li>
<li><a href="/2015/05/">May 2015</a></li>
<li><a href="/2015/02/">February 2015</a></li>
<li><a href="/2014/08/">August 2014</a></li>
<li><a href="/2014/02/">February 2014</a></li>
<li><a href="/2014/01/">January 2014</a></li>
<li><a href="/2013/12/">December 2013</a></li>
<li><a href="/2013/11/">November 2013</a></li>
<li><a href="/2013/02/">February 2013</a></li>
<li><a href="/2012/11/">November 2012</a></li>
<li><a href="/2012/08/">August 2012</a></li>
<li><a href="/2012/03/">March 2012</a></li>
<li><a href="/2011/09/">September 2011</a></li>
<li><a href="/2011/08/">August 2011</a></li>
<li><a href="/2011/07/">July 2011</a></li>
<li><a href="/2011/06/">June 2011</a></li>
<li><a href="/2011/04/">April 2011</a></li>
<li><a href="/2011/02/">February 2011</a></li>
<li><a href="/2010/10/">October 2010</a></li>
<li><a href="/2010/09/">September 2010</a></li>
<li><a href="/2010/08/">August 2010</a></li>
<li><a href="/2010/06/">June 2010</a></li>
<li><a href="/2010/01/">January 2010</a></li>
<li><a href="/2009/10/">October 2009</a></li>
<li><a href="/2009/09/">September 2009</a></li>
<li><a href="/2009/08/">August 2009</a></li>
<li><a href="/2009/07/">July 2009</a></li>
<li><a href="/2009/06/">June 2009</a></li>
<li><a href="/2009/05/">May 2009</a></li>
</ul>
</div>
<div id="recent-posts-2" class="widget widget_recent_entries">
<h3 class="widget-title">Recent Posts</h3>
<ul>
<li> <a href="/2021/01/02/double-helping-of-pi-hole/">Double helping of Pi Hole</a>
</li>
<li> <a href="/2019/07/16/dns-over-https-in-a-snap/">DNS over HTTPS in a snap</a>
</li>
<li> <a href="/2019/06/11/whizzy-labs-wireless-sensor/">Whizzy Labs Wireless Sensor</a>
</li>
<li> <a href="/2019/05/07/ubuntu-developer-desktop-survey-2019/">Ubuntu Developer Desktop Survey 2019</a>
</li>
<li> <a href="/2017/05/19/ubuntu-desktop-goings-on-friday-19th-may-2017/">Ubuntu Desktop goings on.  Friday 19th May 2017</a>
</li>
</ul>
</div>
<div id="categories-4" class="widget widget_categories">
<h3 class="widget-title">Categories</h3>
<ul>
<li class="cat-item cat-item-2"><a href="/category/alexa/">Alexa</a></li>
<li class="cat-item cat-item-3"><a href="/category/arduino/">Arduino</a></li>
<li class="cat-item cat-item-4"><a href="/category/asterisk/">asterisk</a></li>
<li class="cat-item cat-item-5"><a href="/category/google-maps/">Google Maps</a></li>
<li class="cat-item cat-item-6"><a href="/category/iot/">IoT</a></li>
<li class="cat-item cat-item-7"><a href="/category/javascript/">Javascript</a></li>
<li class="cat-item cat-item-8"><a href="/category/linux/">linux</a></li>
<li class="cat-item cat-item-9"><a href="/category/making-the-world-a-better-place/">Making the world a better place</a></li>
<li class="cat-item cat-item-10"><a href="/category/raspberrypi/">RaspberryPi</a></li>
<li class="cat-item cat-item-12"><a href="/category/so-called-humor/">So called humor</a></li>
<li class="cat-item cat-item-13"><a href="/category/tv/">tv</a></li>
<li class="cat-item cat-item-14"><a href="/category/ubuntu-2/">Ubuntu</a></li>
<li class="cat-item cat-item-15"><a href="/category/uncategorized/">Uncategorized</a></li>
</ul>
</div>
</div></aside></div>
</div></div>
</div>
<footer id="footer" class="site-footer"> <a href="#" id="toTop" class="toTop"><i class="fa fa-angle-up"></i></a><div class="footer-sidebar"><div class="container"><div class="row">
<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
<div id="archives-2" class="widget widget_archive">
<h4 class="widget-title">Archives</h4>
<ul>
<li><a href="/2021/01/">January 2021</a></li>
<li><a href="/2019/07/">July 2019</a></li>
<li><a href="/2019/06/">June 2019</a></li>
<li><a href="/2019/05/">May 2019</a></li>
<li><a href="/2017/05/">May 2017</a></li>
<li><a href="/2017/03/">March 2017</a></li>
<li><a href="/2017/02/">February 2017</a></li>
<li><a href="/2016/12/">December 2016</a></li>
<li><a href="/2016/11/">November 2016</a></li>
<li><a href="/2016/10/">October 2016</a></li>
<li><a href="/2016/09/">September 2016</a></li>
<li><a href="/2016/02/">February 2016</a></li>
<li><a href="/2015/12/">December 2015</a></li>
<li><a href="/2015/10/">October 2015</a></li>
<li><a href="/2015/09/">September 2015</a></li>
<li><a href="/2015/06/">June 2015</a></li>
<li><a href="/2015/05/">May 2015</a></li>
<li><a href="/2015/02/">February 2015</a></li>
<li><a href="/2014/08/">August 2014</a></li>
<li><a href="/2014/02/">February 2014</a></li>
<li><a href="/2014/01/">January 2014</a></li>
<li><a href="/2013/12/">December 2013</a></li>
<li><a href="/2013/11/">November 2013</a></li>
<li><a href="/2013/02/">February 2013</a></li>
<li><a href="/2012/11/">November 2012</a></li>
<li><a href="/2012/08/">August 2012</a></li>
<li><a href="/2012/03/">March 2012</a></li>
<li><a href="/2011/09/">September 2011</a></li>
<li><a href="/2011/08/">August 2011</a></li>
<li><a href="/2011/07/">July 2011</a></li>
<li><a href="/2011/06/">June 2011</a></li>
<li><a href="/2011/04/">April 2011</a></li>
<li><a href="/2011/02/">February 2011</a></li>
<li><a href="/2010/10/">October 2010</a></li>
<li><a href="/2010/09/">September 2010</a></li>
<li><a href="/2010/08/">August 2010</a></li>
<li><a href="/2010/06/">June 2010</a></li>
<li><a href="/2010/01/">January 2010</a></li>
<li><a href="/2009/10/">October 2009</a></li>
<li><a href="/2009/09/">September 2009</a></li>
<li><a href="/2009/08/">August 2009</a></li>
<li><a href="/2009/07/">July 2009</a></li>
<li><a href="/2009/06/">June 2009</a></li>
<li><a href="/2009/05/">May 2009</a></li>
</ul>
</div>
<div id="categories-2" class="widget widget_categories">
<h4 class="widget-title">Categories</h4>
<ul>
<li class="cat-item cat-item-2"><a href="/category/alexa/">Alexa</a></li>
<li class="cat-item cat-item-3"><a href="/category/arduino/">Arduino</a></li>
<li class="cat-item cat-item-4"><a href="/category/asterisk/">asterisk</a></li>
<li class="cat-item cat-item-5"><a href="/category/google-maps/">Google Maps</a></li>
<li class="cat-item cat-item-6"><a href="/category/iot/">IoT</a></li>
<li class="cat-item cat-item-7"><a href="/category/javascript/">Javascript</a></li>
<li class="cat-item cat-item-8"><a href="/category/linux/">linux</a></li>
<li class="cat-item cat-item-9"><a href="/category/making-the-world-a-better-place/">Making the world a better place</a></li>
<li class="cat-item cat-item-10"><a href="/category/raspberrypi/">RaspberryPi</a></li>
<li class="cat-item cat-item-12"><a href="/category/so-called-humor/">So called humor</a></li>
<li class="cat-item cat-item-13"><a href="/category/tv/">tv</a></li>
<li class="cat-item cat-item-14"><a href="/category/ubuntu-2/">Ubuntu</a></li>
<li class="cat-item cat-item-15"><a href="/category/uncategorized/">Uncategorized</a></li>
</ul>
</div>
</div>
<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4"></div>
<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4"></div>
</div></div></div>
<div class="footer-inner"><div class="container">
<p class="social-profile type1 pull-right"> <a href="https://twitter.com/8none1" class="button-twitter" title="Twitter" target="_blank"><i class="fa fa-twitter-square"></i></a> <a href="https://github.com/8none1" class="button-google" title="Google +" target="_blank"><i class="fa fa-google-plus-square"></i></a> <a href="https://www.youtube.com/user/willcooke1" class="button-youtube" title="Youtube" target="_blank"><i class="fa fa-youtube-square"></i></a></p>
<p class="copyright"><span class="copyright-date"> &copy; Copyright 2021 </span> <a href="/" title="whizzy.org" target="_blank">whizzy.org</a> &#8226; Designed by <a href="https://motopress.com/" rel="nofollow" title="Premium WordPress Plugins and Themes">MotoPress</a> &#8226; Proudly Powered by <a href="http://wordpress.org/" rel="nofollow" title="Semantic Personal Publishing Platform">WordPress</a></p>
</div></div></footer>
</div> <noscript><style>.lazyload{display:none;}</style></noscript>
<script data-noptimize="1">window.lazySizesConfig=window.lazySizesConfig||{};window.lazySizesConfig.loadMode=1;</script><script async data-noptimize="1" src="/wp-content/plugins/autoptimize/classes/external/js/lazysizes.min.js?ao_version=2.8.4"></script> <script type="text/javascript" id="emmet-script-js-extra">var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
var template_directory_uri = {"url":"https:\/\/www.whizzy.org\/wp-content\/themes\/emmet-lite"};</script> <script>/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);</script> <script defer src="/wp-content/cache/autoptimize/js/autoptimize_78789ca997016d9e81ffd10b2fcdec4f.js"></script>
</body>
</html>