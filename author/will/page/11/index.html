<!DOCTYPE html>
<html lang="en-GB">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">
<link rel="stylesheet" media="print" href="/wp-content/cache/autoptimize/css/autoptimize_ad69f4871caf44872ba0f8df0a19d0dc.css" onload="this.onload=null;this.media='all';">
<noscript id="aonoscrcss"><link media="all" href="/wp-content/cache/autoptimize/css/autoptimize_ad69f4871caf44872ba0f8df0a19d0dc.css" rel="stylesheet"></noscript>
<title>will &#8211; Page 11 &#8211; whizzy.org</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Posts by will Feed" href="/author/will/feed/"> <script type="text/javascript">window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.whizzy.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);</script> <link rel="stylesheet" id="googleOpenSans-css" href="//fonts.googleapis.com/css?family=Open+Sans%3A400%2C400italic%2C600%2C700%2C700italic&#038;subset=latin%2Ccyrillic&#038;ver=5.7.2" type="text/css" media="all"> <script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.5.1" id="jquery-core-js"></script> <link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/users/1">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 5.7.2">
</head>
<body class="archive paged author author-will author-1 custom-background paged-11 author-paged-11 emmet pages-background"> <a class="skip-link screen-reader-text" href="#main"> Skip to content</a><div class="wrapper  ">
<header id="header" class="main-header"><div class="top-header"><div class="container">
<div class="top-menu">
<ul id="menu-top-menu" class="menu"></ul>
<div class="clearfix"></div>
</div>
<div class="social-profile type1 "> <a href="https://twitter.com/8none1" class="button-twitter" title="Twitter" target="_blank"><i class="fa fa-twitter-square"></i></a> <a href="https://github.com/8none1" class="button-google" title="Google +" target="_blank"><i class="fa fa-google-plus-square"></i></a> <a href="https://www.youtube.com/user/willcooke1" class="button-youtube" title="Youtube" target="_blank"><i class="fa fa-youtube-square"></i></a>
</div>
<div class="contact-info ">
<ul class=" info-list"></ul>
<div class="clearfix"></div>
</div>
</div></div>
<div class="site-header" data-sticky-menu="off"><div class="container">
<div class="site-logo"> <a class="home-link" href="/" title="whizzy.org" rel="home"><div class="site-description">
<p class="site-title ">whizzy.org</p>
<p class="site-tagline">On code and gadgets.</p>
</div> </a>
</div> <button class="menu-toggle" aria-controls="main-menu" aria-expanded="false"><span class="menu-show">Menu</span> <span class="menu-close">Close</span>  </button><div id="navbar" class="navbar"><nav id="site-navigation" class="main-navigation"><ul class="sf-menu"></ul></nav></div>
<div class="clearfix"></div>
</div></div></header><div id="main" class="site-main">
<div class="container breadcrumb-wrapper"><div class="breadcrumb breadcrumbs sp-breadcrumbs"><div class="breadcrumb-trail">
<a href="/" title="whizzy.org" rel="home" class="trail-begin">Home</a> <span class="sep"><i class="fa fa-angle-right"></i></span> <span class="trail-end">will</span>
</div></div></div>
<div class="container main-container"><div class="row clearfix">
<div class=" col-xs-12 col-sm-12 col-md-8 col-lg-8">
<article id="post-443" class="post-in-blog post post-443 type-post status-publish format-standard hentry category-asterisk"><header class="entry-header"><h2 class="entry-title"> <a href="/2013/02/12/asterisk-uk-caller-id-sms-redux/" rel="bookmark">Asterisk UK Caller ID &#038; SMS redux</a>
</h2></header><section class="entry entry-content"><p><span style="text-decoration: underline;"><strong>Update 28 Dec 2013:</strong> </span> As far as caller ID goes, I might have been barking up completely the wrong tree here.  Have a look here: <a href="http://forums.digium.com/viewtopic.php?f=1&amp;t=85028">http://forums.digium.com/viewtopic.php?f=1&amp;t=85028</a>.  I&#8217;ve re-implemented that patch for Dahdi and I&#8217;m testing it now.  Get in touch if you want to test it as well.  Once I&#8217;m happy it&#8217;s actually working, I&#8217;ll post it here.</p>
<p>&nbsp;</p>
<p><strong>tl;dr: Scroll down to “How to fix Caller ID in the UK on Asterisk 11 and Dahdi 2.6.1″</strong></p>
<p>I’ve been having some problems with Asterisk 1.6 for a while now, in that when I’m dialled in to conferences via SIP, or when I call someone via the work Asterisk server from my Asterisk server at home I get cut off every 15 minutes. My colleagues have all kind of accepted this now, it was starting to get annoying. It was a known problem in Asterisk 1.6, and so I was going to have to upgrade.</p>
<p>The Ubuntu Asterisk packages are fairly up-to-date but FreePBX isn’t packaged, and it’s a pain in the backside to get set up with the correct permissions, especially if you install Asterisk from packages. I had a spare machine anyway so I decided that I’d give FreePBX Distro a go and once I’d burnt the ISO to a CD (ya rly) I found the set up process to be simple and quick.</p>
<p>FreePBX Distro is a stripped down CentOS (2.6.32 kernel) which boots quick, has minimal footprint and bundles in loads and loads of FreePBX “apps” like conferences, voicemail, blacklisting and makes setting up extensions a breeze. It also includes things like kernel source for <a style="text-decoration: none" href="http://www.isettlements.com/blog/time-to-sell-my-structured-settlement/"><font color="#555555">I sell settlement</font></a> so building extra modules from source is pretty easy. Which is a good job, because it was about to get messy.</p>
<p>If you’ve found this page via Google then this will probably sound pretty familiar:</p>
<ul>
<li>You got a TDM400p four port FXO/FXS interface card, or a clone from someone like OpenVox (which work perfectly by the way – as do those cheap daughter cards off eBay).</li>
<li>You’ve upgraded to <strong>Asterisk 11</strong>, or <strong>Asterisk 1.8</strong> perhaps, or changed to the <strong>Dahdi 2.6.1</strong> drivers and all of a sudden your ”<strong>UK Caller ID</strong>” has “<strong>stopped working</strong>” or at the very least become “<strong>intermittent</strong>“.</li>
<li>It was working fine before, so it’s <strong>not a hardware issue</strong> and your phone provided have <strong>NOT suddenly stopped sending caller ID information</strong>, regardless of what people of forums tell you. No, in fact this is clearly a bug which has crept in somewhere along the line.</li>
<li>You’ve searched and searched and tried things like setting<strong> rxgain=x.x</strong> and <strong>txgain=x.x</strong> or whatever. (Side note: setting txgain and rxgain in chan_dahdi_channels_custom.conf has no effect, the only place is seems to work is in <strong>chan_dahdi_groups.conf</strong>)</li>
<li>You might have even stumbled across a post hinting that <strong>cid_rxgain=x.x</strong> will solve your problems, only it didn’t</li>
</ul>
<p>If that sounds like you, dear reader, then read on. I am your salvation.</p>
<ol>
<li>This page: http://downloads.openvox.cn/pub/drivers/callerid_patches/ (I can only attribute this discovery to divine intervention)</li>
<li>Find a new wctdm.c driver here: http://downloads.openvox.cn/pub/drivers/callerid_patches/2.6.1-wctdm.c</li>
<li>Download the 2.6.1 Dahdi source from here: http://downloads.asterisk.org/pub/telephony/dahdi-linux-complete/dahdi-linux-complete-2.6.1+2.6.1.tar.gz</li>
<li>Replace dahdi-linux-complete-2.6.1+2.6.1/linux/drivers/dahdi/wctdm.c with the version downloaded from openvox</li>
<li>Note it doesn’t compile, add the missing semicolon to line 333 (or thereabouts), successfully build and install the new driver</li>
<li>You might need to change /etc/modprobe.d/dahdi.conf and add:</li>
</ol>
<pre>options wctdm opermode=UK fwringdetect=1 battthresh=4</pre>
<ol><li>restart Dahdi and Asterisk and caller ID should now be fixed! Yay!</li></ol>
<h1>How to fix Caller ID in the UK on Asterisk 11 and Dahdi 2.6.1</h1>
<p>Here is a patch against wctdm.c from stock Dahdi 2.6.1 with the fixes in: <a href="/wp-content/uploads/2013/02/wctdm.c.patch">wctdm.c</a>.patch</p>
<p><strong>OR:</strong> Replace dahdi-linux-complete-2.6.1+2.6.1/linux/drivers/dahdi/wctdm.c with this one: <a href="/wp-content/uploads/2013/02/wctdm.c">wctdm</a>.c</p>
<p><strong>OR:</strong> If you’re running FreePBX distro 64 bit “BETA-3.211.63-5 Release Date-01-24-13″ (or close) here is a binary driver: <a href="/wp-content/uploads/2013/02/wctdm.ko">wctdm</a>.ko  Move it to /lib/modules/2.6.32-279.11.1.el6.x86_64/dahdi/wctdm.ko</p>
<p>It works for me. I have not had to increase the rxgain, or txgain or anything else. It just works.</p>
<p>Once that’s working, we can move on to…</p>
<h1>How to send &amp; receive SMS in the UK on FreePBX Distro Beta 3.211</h1>
<p>I’ve talked about receiving and sending SMSes before, but that was quite a long time ago, and things have moved on a bit since then. I’ve also learnt a bit more about the Asterisk dial plan, and have a slightly cleaner way of doing it now.</p>
<p>You need to have working caller ID. Hint: see above.<br> You need to install smsq.<br> smsq doesn’t come built in FreePBX Distro so you have to build it yourself if you want to send SMS. This is pretty easy:</p>
<ol>
<li>Download the Asterisk 11.2.1 source from here: http://downloads.asterisk.org/pub/telephony/asterisk/asterisk-11.2.1.tar.gz</li>
<li>Install popt: yum install popt-devel.i686 popt.i686 popt.x86_64 popt-devel.x86_64 (prerequisite for smsq)</li>
<li>In the Asterisk source directory do “./configure”</li>
<li>run “make menuselect”</li>
<li>Scroll down to “Utilities”</li>
<li>In the right hand pane, check “smsq”</li>
<li>Save &amp; Exit</li>
<li>run “make”</li>
<li>DO NOT run “make install” as this will trash your FreePBX config</li>
<li>Once that’s done you should find an executable smsq in the utils directory</li>
</ol>
<p>Just to be sure, create /var/spool/asterisk/sms/motx and /var/spool/asterisk/sms/mtrx<br> You can find more details on building Asterisk here: http://blogs.digium.com/2012/11/05/how-to-install-asterisk-11-on-centos-6/</p>
<p>You need to be able to send SMS in order to register with the BT SMS system, otherwise when you receive an SMS you will get a phone call from the BT robots who will read the text to you, badly.</p>
<p>To register with BT try this:</p>
<pre>&lt;path to smsq&gt;/smsq –motx-channel=DAHDI/2/17094009 -d 00000 -m “test”</pre>
<p>where DAHDI/2 is the channel number of your outgoing line.</p>
<p>If you look in the Asterisk logs you should see the message going out with some TX and RX hex dumps. If it works, a short while later you will receive a phone call from either the SMS system trying to talk modem at you, or the robot. Either way, this means your text went out. Great success!</p>
<p>Now we need to set up receive, which is pretty straight forward.</p>
<p>Edit /etc/asterisk/extensions_custom.conf and add the below. Note – I’ve added a lot of comments to explain what’s going on, it might improve readability if you take them out.</p>
<pre>[from-internal-additional-custom]
;; This makes sure our new 'app' gets included in the FreePBX dial plan
include =&gt; app-rx-sms
[app-rx-sms]
;; This is the app to receive an SMS which will be called when we match
;; the caller ID of an incoming call to the BT computer
exten =&gt; s,1,Answer()
;; This wait seems to help
exten =&gt; s,n,Wait(0.5)
;; We simply use the built in SMS function
exten =&gt; s,n,SMS(default,a)
;; Hangup with code 16, normal termination.
exten =&gt; s,n,Hangup(16)
;; Done
;; We also extend the from-pstn context with a branch to the SMS app
;; if the caller ID matches, hence why it's necessary to get caller
;; id working first
[from-pstn-custom]
;; we add ourselves in to the end of the current dialplan
;; priority 7 gets us there...
exten =&gt; s,7,GotoIf($["${CALLERID(num)}" = "08005875290"]?app-rx-sms,s,1)
;; pretty simple - if the caller ID matches, go to the sms app
exten =&gt; s,n(dest-ext),Goto(ext-group,1100,1)
;; Note: 1100 is my "ring all" group. You will need to change 1100
;; to what ever you use. You should see this at the end of the
;; from-pstn context in extensions_additional.conf</pre>
<p>Save that, and in asterisk do a “dialplan reload”. From smsq send an SMS to 00000 saying “register”· If everything works you should get a text file in /var/spool/asterisk/sms/mtrx.</p>
<div class="clearfix"></div></section><footer class="entry-footer"><div class="meta"> <span class="author">Posted by </span><a href="/author/will/" title="Posts by will" rel="author">will</a> <span class="seporator">/</span> <span class="date-post h6">February 12, 2013</span> <span class="seporator">/</span> <span>Posted in</span> <a href="/category/asterisk/" rel="category tag">asterisk</a>
</div></footer></article><article id="post-425" class="post-in-blog post post-425 type-post status-publish format-standard hentry category-linux category-making-the-world-a-better-place category-tv"><header class="entry-header"><h2 class="entry-title"> <a href="/2012/11/26/device-control-over-hdmi-via-cec-libcec-ftw/" rel="bookmark">Device control over HDMI via CEC.  libcec FTW.</a>
</h2></header><section class="entry entry-content"><p>Blimey, it&#8217;s been a while.  I&#8217;ve been a bit busy, and let&#8217;s be honest; writing up blog posts always sounds like a good idea, but when you get in to it &#8211; it&#8217;s really hard work.</p>
<p>Anyway &#8211; I finally got round to buying a Pulse-Eight CEC to USB adapter:  <a href="http://www.pulse-eight.com/store/products/104-usb-hdmi-cec-adapter.aspx">http://www.pulse-eight.com/store/products/104-usb-hdmi-cec-adapter.aspx</a></p>
<p>This awesome little box of tricks makes up for the lack of CEC control in the vast majority of HDMI-Out equipped graphics cards.  It&#8217;s the final piece in the jigsaw of a Linux based home entertainment device.  It allows you to talk to the other devices in your HDMI network; your surround sound amplifier and your big screen TV being the best examples (assuming they support CEC of course).</p>
<p>CEC has been around for a long time but for some reason it doesn&#8217;t seem to be widely used, or very well implemented, in most consumer electronics devices.  It&#8217;s a published standard but with OEM manufacturers wanting to differentiate their products and introduce a bit of vendor lock-in, they all call it something different.  The fact is that your Toshiba Regza Link TV will talk to your Sony Bravia Link Amp just fine, for the most part.  There might be a couple of proprietary things which don&#8217;t work, but on, off, volume up, volume down etc will all just work.</p>
<p>Pulse Eight&#8217;s USB to CEC adapter lets your computer get in on the act too, and opens up a whole realm of automatic switching, which really cuts down on the number of remote controls you need and the number of buttons you have to remember the purpose of.</p>
<p>The good folk at Pulse Eight have also made libCEC, an open source library to allow pretty much any software to take advantage of the USB adapter.  <a href="http://libcec.pulse-eight.com/">http://libcec.pulse-eight.com/</a></p>
<p>It comes with C++, C and .NET interfaces, and a CLI utility called cec-client.  XBMC &amp; MythTV already support libCEC and have some neat features baked right in.  It&#8217;s good, but it&#8217;s not exactly what I was looking for &#8211; I want a bit more control.</p>
<p>Now, I don&#8217;t know anything about C++ or C or .NET, so until someone writes some Python bindings, my ticket to this party lies solely with the CLI utility cec-client.  It can do most things on the &#8220;transmit&#8221; side, so you can send commands to your other CEC devices fairly easily.  Acting on a request, or listening to the CEC traffic is a bit more complex &#8211; but not beyond the realms of possibility.</p>
<p>This weekend I wrote (and rewrote and rewrote) a couple of Bash scripts to:</p>
<ul>
<li>Let me control the system volume (i.e. the real hardware, not the mixer on the computer) on the TV &amp; Amp from the PCs remote control</li>
<li>Let me switch the TV &amp; Amp on and off</li>
<li>Activate proper muting, again not the mixer on the computer &#8211; the hardware itself</li>
<li>Switch the amp &amp; TV to my MythTV PC</li>
<li>Power off all the hardware when the PC suspends, and then switching it all back on again</li>
<li>Shut the whole lot down when the screensaver on the PC kicks in.</li>
</ul>
<p style="text-align: left;">I make these scripts available for your amusement:</p>
<div><ul>
<li><a href="/wp-content/uploads/2012/11/cecserver.sh_.txt">cecserver.sh</a></li>
<li><a href="/wp-content/uploads/2012/11/cecsimple.sh_.txt">cecsimple.sh</a></li>
</ul></div>
<p>cecsimple is a client of the &#8220;server&#8221; which itself is a client of cec-client.  Fire up the server and then issue it commands down the FIFO either directly or via the abstraction layer which is cecsimple.sh.</p>
<p>&nbsp;</p>
<p>I hooked up the volume control and amp power via &#8220;irexec&#8221; and lirc.  I tell irexec to execute, for example, &#8220;cecsimple.sh volup&#8221; or &#8220;cecsimple.sh ampon&#8221;.  If the server component is already running then these commands are sent very quickly and you don&#8217;t really notice the lag.</p>
<p>To switch the TV off when the PC goes in to suspend mode I added a script in /etc/pm/sleep.d which calls &#8220;cecsimple.sh tvoff&#8221; and then &#8220;cecsimple.sh tvon&#8221; when it resumes.  In theory if the TV is using the Amp to output surround sound audio then the TV will tell the Amp to turn off, it it&#8217;s not &#8211; it wont.</p>
<p>To switch things off when the screensaver kicks in, I simply &#8220;sudo pm-suspend&#8221; from an &#8220;xscreensaver-command -watch&#8221; script.</p>
<p>&nbsp;</p>
<p>The practical upshot is that I can now control 99% of my media centre from a single remote control.  I&#8217;ve opted to use the remote connected to the PC as I found it to be the least laggy &#8211; using the TV remote to send up/down/left/right etc to the PC was sluggish.</p>
<p>&nbsp;</p>
<p>I think it should be possible to parse the log output from cec-client and write a &#8220;listener&#8221; component too, but it&#8217;s probably a better idea to learn some rudimentary C and do it properly.  Or some Python bindings.  Oh yeah, and you know what would be really cool, a hook in to MythTV so that when I&#8217;m watching something in surround sound the amp turns on automatically. That would be cool.</p>
<p>&nbsp;</p>
<p>UPDATE 3 Dec 2013:  When someone leaves the amp&#8217;s HDMI switch set on the PS3 and you switch the MythTV box on from the remote, the amp doesn&#8217;t automatically switch to MythTV.  This has been annoying me for a while now, so I fixed it.</p>
<p>In the scripts linked to above the &#8220;active source&#8221; command does this:</p>
<pre>send_command "tx 45 82 11 00"</pre>
<p>4 (the MythTV device) to 5 (the amp) &#8211; 82 (switch active source) to 1.1.0.0 &#8211; but my Sony amp just ignores this request.</p>
<p>I spent some time trying out a few alternatives with cec-client and I&#8217;ve found one which works, and it kinda makes sense why:</p>
<pre>send_command "tx 45 70 11 00"</pre>
<p>4 (MythTV) to 5 (Sony amp) 70 (System Audio Mode) 1.1.0.0 (the input where MythTV is connected)</p>
<p>My assumption is that amp only speaks &#8220;system audio&#8221; &#8211; what with it being an amp.  I&#8217;ve changed the &#8220;activesrc&#8221; with the 45:70:11:00 code and now it works!  (It also switches the amp on, whether I like it or not &#8211; so it&#8217;s not perfect).</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Useful links:</p>
<ul>
<li><a href="http://www.cec-o-matic.com/">http://www.cec-o-matic.com/</a></li>
<li><a href="http://www.jwz.org/xscreensaver/man3.html">http://www.jwz.org/xscreensaver/man3.html</a></li>
<li><a href="https://github.com/Pulse-Eight/libcec">https://github.com/Pulse-Eight/libcec</a></li>
</ul>
<p>&nbsp;</p>
<div class="clearfix"></div></section><footer class="entry-footer"><div class="meta"> <span class="author">Posted by </span><a href="/author/will/" title="Posts by will" rel="author">will</a> <span class="seporator">/</span> <span class="date-post h6">November 26, 2012</span> <span class="seporator">/</span> <span>Posted in</span> <a href="/category/linux/" rel="category tag">linux</a><span>,</span> <a href="/category/making-the-world-a-better-place/" rel="category tag">Making the world a better place</a><span>,</span> <a href="/category/tv/" rel="category tag">tv</a>
</div></footer></article><article id="post-415" class="post-in-blog post post-415 type-post status-publish format-standard hentry category-uncategorized"><header class="entry-header"><h2 class="entry-title"> <a href="/2012/08/16/fixing-warning-please-check-that-your-locale-settings/" rel="bookmark">Fixing &#8220;warning: Please check that your locale settings&#8221;</a>
</h2></header><section class="entry entry-content"><p>I took an Amazon AWS t1.micro instance for a spin the other day. A free server is not to be sniffed at. Of course I installed Ubuntu 12.04 on it.</p>
<p>I was getting a lot of locale errors, things like this:</p>
<pre>perl: warning: Setting locale failed.
 perl: warning: Please check that your locale settings:
 LANGUAGE = (unset),
 LC_ALL = (unset),
 LC_MESSAGES = "en_GB.UTF-8",
 LC_COLLATE = "en_GB.UTF-8",
 LC_CTYPE = "en_GB.UTF-8",
 LANG = "en_US.UTF-8"
 are supported and installed on your system.</pre>
<p>I thought this would just go away by itself, but it didn&#8217;t &#8211; so I had to fix it. Note: I&#8217;m in the UK, so I&#8217;m using en_GB as my locale, change yours to en_US or whatever.</p>
<p>Type:</p>
<pre>export LANGUAGE=en_GB.UTF-8
sudo locale-gen en_GB.UTF-8
sudo dpkg-reconfigure locales</pre>
<p>And you should be all set.</p>
<div class="clearfix"></div></section><footer class="entry-footer"><div class="meta"> <span class="author">Posted by </span><a href="/author/will/" title="Posts by will" rel="author">will</a> <span class="seporator">/</span> <span class="date-post h6">August 16, 2012</span> <span class="seporator">/</span> <span>Posted in</span> <a href="/category/uncategorized/" rel="category tag">Uncategorized</a>
</div></footer></article><nav class="navigation paging-navigation"> <a class="prev page-numbers" href="/author/will/page/10/">&laquo; Previous</a> <a class="page-numbers" href="/author/will/">1</a> <span class="page-numbers dots">&hellip;</span> <a class="page-numbers" href="/author/will/page/9/">9</a> <a class="page-numbers" href="/author/will/page/10/">10</a> <span aria-current="page" class="page-numbers current">11</span> <a class="page-numbers" href="/author/will/page/12/">12</a> <a class="page-numbers" href="/author/will/page/13/">13</a> <span class="page-numbers dots">&hellip;</span> <a class="page-numbers" href="/author/will/page/24/">24</a> <a class="next page-numbers" href="/author/will/page/12/">Next &raquo;</a></nav>
</div>
<div class=" col-xs-12 col-sm-12 col-md-4 col-lg-4"><aside id="sidebar"><div class="widget-area">
<div id="archives-4" class="widget widget_archive">
<h3 class="widget-title">Archives</h3>
<ul>
<li><a href="/2021/01/">January 2021</a></li>
<li><a href="/2019/07/">July 2019</a></li>
<li><a href="/2019/06/">June 2019</a></li>
<li><a href="/2019/05/">May 2019</a></li>
<li><a href="/2017/05/">May 2017</a></li>
<li><a href="/2017/03/">March 2017</a></li>
<li><a href="/2017/02/">February 2017</a></li>
<li><a href="/2016/12/">December 2016</a></li>
<li><a href="/2016/11/">November 2016</a></li>
<li><a href="/2016/10/">October 2016</a></li>
<li><a href="/2016/09/">September 2016</a></li>
<li><a href="/2016/02/">February 2016</a></li>
<li><a href="/2015/12/">December 2015</a></li>
<li><a href="/2015/10/">October 2015</a></li>
<li><a href="/2015/09/">September 2015</a></li>
<li><a href="/2015/06/">June 2015</a></li>
<li><a href="/2015/05/">May 2015</a></li>
<li><a href="/2015/02/">February 2015</a></li>
<li><a href="/2014/08/">August 2014</a></li>
<li><a href="/2014/02/">February 2014</a></li>
<li><a href="/2014/01/">January 2014</a></li>
<li><a href="/2013/12/">December 2013</a></li>
<li><a href="/2013/11/">November 2013</a></li>
<li><a href="/2013/02/">February 2013</a></li>
<li><a href="/2012/11/">November 2012</a></li>
<li><a href="/2012/08/">August 2012</a></li>
<li><a href="/2012/03/">March 2012</a></li>
<li><a href="/2011/09/">September 2011</a></li>
<li><a href="/2011/08/">August 2011</a></li>
<li><a href="/2011/07/">July 2011</a></li>
<li><a href="/2011/06/">June 2011</a></li>
<li><a href="/2011/04/">April 2011</a></li>
<li><a href="/2011/02/">February 2011</a></li>
<li><a href="/2010/10/">October 2010</a></li>
<li><a href="/2010/09/">September 2010</a></li>
<li><a href="/2010/08/">August 2010</a></li>
<li><a href="/2010/06/">June 2010</a></li>
<li><a href="/2010/01/">January 2010</a></li>
<li><a href="/2009/10/">October 2009</a></li>
<li><a href="/2009/09/">September 2009</a></li>
<li><a href="/2009/08/">August 2009</a></li>
<li><a href="/2009/07/">July 2009</a></li>
<li><a href="/2009/06/">June 2009</a></li>
<li><a href="/2009/05/">May 2009</a></li>
</ul>
</div>
<div id="recent-posts-2" class="widget widget_recent_entries">
<h3 class="widget-title">Recent Posts</h3>
<ul>
<li> <a href="/2021/01/02/double-helping-of-pi-hole/">Double helping of Pi Hole</a>
</li>
<li> <a href="/2019/07/16/dns-over-https-in-a-snap/">DNS over HTTPS in a snap</a>
</li>
<li> <a href="/2019/06/11/whizzy-labs-wireless-sensor/">Whizzy Labs Wireless Sensor</a>
</li>
<li> <a href="/2019/05/07/ubuntu-developer-desktop-survey-2019/">Ubuntu Developer Desktop Survey 2019</a>
</li>
<li> <a href="/2017/05/19/ubuntu-desktop-goings-on-friday-19th-may-2017/">Ubuntu Desktop goings on.  Friday 19th May 2017</a>
</li>
</ul>
</div>
<div id="categories-4" class="widget widget_categories">
<h3 class="widget-title">Categories</h3>
<ul>
<li class="cat-item cat-item-2"><a href="/category/alexa/">Alexa</a></li>
<li class="cat-item cat-item-3"><a href="/category/arduino/">Arduino</a></li>
<li class="cat-item cat-item-4"><a href="/category/asterisk/">asterisk</a></li>
<li class="cat-item cat-item-5"><a href="/category/google-maps/">Google Maps</a></li>
<li class="cat-item cat-item-6"><a href="/category/iot/">IoT</a></li>
<li class="cat-item cat-item-7"><a href="/category/javascript/">Javascript</a></li>
<li class="cat-item cat-item-8"><a href="/category/linux/">linux</a></li>
<li class="cat-item cat-item-9"><a href="/category/making-the-world-a-better-place/">Making the world a better place</a></li>
<li class="cat-item cat-item-10"><a href="/category/raspberrypi/">RaspberryPi</a></li>
<li class="cat-item cat-item-12"><a href="/category/so-called-humor/">So called humor</a></li>
<li class="cat-item cat-item-13"><a href="/category/tv/">tv</a></li>
<li class="cat-item cat-item-14"><a href="/category/ubuntu-2/">Ubuntu</a></li>
<li class="cat-item cat-item-15"><a href="/category/uncategorized/">Uncategorized</a></li>
</ul>
</div>
</div></aside></div>
</div></div>
</div>
<footer id="footer" class="site-footer"> <a href="#" id="toTop" class="toTop"><i class="fa fa-angle-up"></i></a><div class="footer-sidebar"><div class="container"><div class="row">
<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
<div id="archives-2" class="widget widget_archive">
<h4 class="widget-title">Archives</h4>
<ul>
<li><a href="/2021/01/">January 2021</a></li>
<li><a href="/2019/07/">July 2019</a></li>
<li><a href="/2019/06/">June 2019</a></li>
<li><a href="/2019/05/">May 2019</a></li>
<li><a href="/2017/05/">May 2017</a></li>
<li><a href="/2017/03/">March 2017</a></li>
<li><a href="/2017/02/">February 2017</a></li>
<li><a href="/2016/12/">December 2016</a></li>
<li><a href="/2016/11/">November 2016</a></li>
<li><a href="/2016/10/">October 2016</a></li>
<li><a href="/2016/09/">September 2016</a></li>
<li><a href="/2016/02/">February 2016</a></li>
<li><a href="/2015/12/">December 2015</a></li>
<li><a href="/2015/10/">October 2015</a></li>
<li><a href="/2015/09/">September 2015</a></li>
<li><a href="/2015/06/">June 2015</a></li>
<li><a href="/2015/05/">May 2015</a></li>
<li><a href="/2015/02/">February 2015</a></li>
<li><a href="/2014/08/">August 2014</a></li>
<li><a href="/2014/02/">February 2014</a></li>
<li><a href="/2014/01/">January 2014</a></li>
<li><a href="/2013/12/">December 2013</a></li>
<li><a href="/2013/11/">November 2013</a></li>
<li><a href="/2013/02/">February 2013</a></li>
<li><a href="/2012/11/">November 2012</a></li>
<li><a href="/2012/08/">August 2012</a></li>
<li><a href="/2012/03/">March 2012</a></li>
<li><a href="/2011/09/">September 2011</a></li>
<li><a href="/2011/08/">August 2011</a></li>
<li><a href="/2011/07/">July 2011</a></li>
<li><a href="/2011/06/">June 2011</a></li>
<li><a href="/2011/04/">April 2011</a></li>
<li><a href="/2011/02/">February 2011</a></li>
<li><a href="/2010/10/">October 2010</a></li>
<li><a href="/2010/09/">September 2010</a></li>
<li><a href="/2010/08/">August 2010</a></li>
<li><a href="/2010/06/">June 2010</a></li>
<li><a href="/2010/01/">January 2010</a></li>
<li><a href="/2009/10/">October 2009</a></li>
<li><a href="/2009/09/">September 2009</a></li>
<li><a href="/2009/08/">August 2009</a></li>
<li><a href="/2009/07/">July 2009</a></li>
<li><a href="/2009/06/">June 2009</a></li>
<li><a href="/2009/05/">May 2009</a></li>
</ul>
</div>
<div id="categories-2" class="widget widget_categories">
<h4 class="widget-title">Categories</h4>
<ul>
<li class="cat-item cat-item-2"><a href="/category/alexa/">Alexa</a></li>
<li class="cat-item cat-item-3"><a href="/category/arduino/">Arduino</a></li>
<li class="cat-item cat-item-4"><a href="/category/asterisk/">asterisk</a></li>
<li class="cat-item cat-item-5"><a href="/category/google-maps/">Google Maps</a></li>
<li class="cat-item cat-item-6"><a href="/category/iot/">IoT</a></li>
<li class="cat-item cat-item-7"><a href="/category/javascript/">Javascript</a></li>
<li class="cat-item cat-item-8"><a href="/category/linux/">linux</a></li>
<li class="cat-item cat-item-9"><a href="/category/making-the-world-a-better-place/">Making the world a better place</a></li>
<li class="cat-item cat-item-10"><a href="/category/raspberrypi/">RaspberryPi</a></li>
<li class="cat-item cat-item-12"><a href="/category/so-called-humor/">So called humor</a></li>
<li class="cat-item cat-item-13"><a href="/category/tv/">tv</a></li>
<li class="cat-item cat-item-14"><a href="/category/ubuntu-2/">Ubuntu</a></li>
<li class="cat-item cat-item-15"><a href="/category/uncategorized/">Uncategorized</a></li>
</ul>
</div>
</div>
<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4"></div>
<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4"></div>
</div></div></div>
<div class="footer-inner"><div class="container">
<p class="social-profile type1 pull-right"> <a href="https://twitter.com/8none1" class="button-twitter" title="Twitter" target="_blank"><i class="fa fa-twitter-square"></i></a> <a href="https://github.com/8none1" class="button-google" title="Google +" target="_blank"><i class="fa fa-google-plus-square"></i></a> <a href="https://www.youtube.com/user/willcooke1" class="button-youtube" title="Youtube" target="_blank"><i class="fa fa-youtube-square"></i></a></p>
<p class="copyright"><span class="copyright-date"> &copy; Copyright 2021 </span> <a href="/" title="whizzy.org" target="_blank">whizzy.org</a> &#8226; Designed by <a href="https://motopress.com/" rel="nofollow" title="Premium WordPress Plugins and Themes">MotoPress</a> &#8226; Proudly Powered by <a href="http://wordpress.org/" rel="nofollow" title="Semantic Personal Publishing Platform">WordPress</a></p>
</div></div></footer>
</div> <noscript><style>.lazyload{display:none;}</style></noscript>
<script data-noptimize="1">window.lazySizesConfig=window.lazySizesConfig||{};window.lazySizesConfig.loadMode=1;</script><script async data-noptimize="1" src="/wp-content/plugins/autoptimize/classes/external/js/lazysizes.min.js?ao_version=2.8.4"></script> <script type="text/javascript" id="emmet-script-js-extra">var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
var template_directory_uri = {"url":"https:\/\/www.whizzy.org\/wp-content\/themes\/emmet-lite"};</script> <script>/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);</script> <script defer src="/wp-content/cache/autoptimize/js/autoptimize_78789ca997016d9e81ffd10b2fcdec4f.js"></script>
</body>
</html>