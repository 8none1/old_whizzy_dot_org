<!DOCTYPE html>
<html lang="en-GB">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="/xmlrpc.php">
	<title>Making the world a better place &#8211; Page 5 &#8211; whizzy.org</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="whizzy.org &raquo; Making the world a better place Category Feed" href="/category/making-the-world-a-better-place/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2" type="text/css" media="all">
<link rel="stylesheet" id="googleOpenSans-css" href="//fonts.googleapis.com/css?family=Open+Sans%3A400%2C400italic%2C600%2C700%2C700italic&#038;subset=latin%2Ccyrillic&#038;ver=5.7.2" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="/wp-content/themes/emmet-lite/css/bootstrap.min.css?ver=3.3.5" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="/wp-content/themes/emmet-lite/css/font-awesome.min.css?ver=4.7.0" type="text/css" media="all">
<link rel="stylesheet" id="flexslider-css" href="/wp-content/themes/emmet-lite/css/flexslider.min.css?ver=2.5.0" type="text/css" media="all">
<link rel="stylesheet" id="emmet-main-css" href="/wp-content/themes/emmet-lite/css/emmet-style.min.css?ver=1.7.5" type="text/css" media="all">
<link rel="stylesheet" id="emmet-style-css" href="/wp-content/themes/emmet-lite/style.css?ver=1.7.5" type="text/css" media="all">
<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.5.1" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/categories/9">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.7.2">
    <style type="text/css" id="theme-header-css">.welcome-right {
            background: url("/wp-content/themes/emmet-lite/images/welcome-image.png") no-repeat scroll left center rgba(0, 0, 0, 0);
        }

                        .third-left {
            background: url("/wp-content/themes/emmet-lite/images/third-image.png") no-repeat scroll right center rgba(0, 0, 0, 0);
        }</style>
    <style type="text/css" id="custom-background-css">body.custom-background { background-image: url("/wp-content/themes/emmet-lite/images/main-bg.jpg"); background-position: center top; background-size: auto; background-repeat: no-repeat; background-attachment: fixed; }</style>
	</head>
<body class="archive paged category category-making-the-world-a-better-place category-9 custom-background paged-5 category-paged-5 emmet pages-background">
<a class="skip-link screen-reader-text" href="#main">
	Skip to content</a>
<div class="wrapper  ">
				<header id="header" class="main-header">
							<div class="top-header">
					<div class="container">
												<div class="top-menu">
							<ul id="menu-top-menu" class="menu"></ul>							<div class="clearfix"></div>
						</div>

						<div class="social-profile type1 ">
																						<a href="https://twitter.com/8none1" class="button-twitter" title="Twitter" target="_blank"><i class="fa fa-twitter-square"></i></a>
																													<a href="https://github.com/8none1" class="button-google" title="Google +" target="_blank"><i class="fa fa-google-plus-square"></i></a>
																																											<a href="https://www.youtube.com/user/willcooke1" class="button-youtube" title="Youtube" target="_blank"><i class="fa fa-youtube-square"></i></a>
																					                            						</div>
						<div class="contact-info ">
							<ul class=" info-list">
																																																									</ul>
							<div class="clearfix"></div>
						</div>
					</div>
				</div>
							<div class="site-header" data-sticky-menu="off">
				<div class="container">
					<div class="site-logo">
													<a class="home-link" href="/" title="whizzy.org" rel="home">
                                											<div class="site-description">
									<p class="site-title ">whizzy.org</p>
																			<p class="site-tagline">On code and gadgets.</p>
																	</div>
							</a>
											</div>
                    <button class="menu-toggle" aria-controls="main-menu" aria-expanded="false"><span class="menu-show">Menu</span>
                        <span class="menu-close">Close</span>
                        
                    </button>
					<div id="navbar" class="navbar">
						<nav id="site-navigation" class="main-navigation">
							<ul class="sf-menu"></ul>						</nav>
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
		</header>
		<div id="main" class="site-main">
    <div class="container breadcrumb-wrapper">
        <div class="breadcrumb breadcrumbs sp-breadcrumbs"><div class="breadcrumb-trail">
<a href="/" title="whizzy.org" rel="home" class="trail-begin">Home</a> <span class="sep"><i class="fa fa-angle-right"></i></span> <span class="trail-end">Making the world a better place</span>
</div></div>    </div>
<div class="container main-container">
    <div class="row clearfix">
        <div class=" col-xs-12 col-sm-12 col-md-8 col-lg-8">
                         
                                                    <article id="post-457" class="post-in-blog post post-457 type-post status-publish format-standard hentry category-google-maps category-javascript category-making-the-world-a-better-place">
                    <header class="entry-header">
        <h2 class="entry-title">
            <a href="/2013/12/17/absolute-beginners-guide-to-google-maps-javascript-v3/" rel="bookmark">Absolute beginners guide to Google Maps JavaScript v3</a>
        </h2>
    </header> 
    <section class="entry entry-content">
        <p>Since I first published my <a title="Absolute beginners guide to Google Maps Javascript" href="/2009/05/absolute-beginners-guide-to-google-maps-javascript/">HowTo</a> and the <a title="Absolute beginners guide to Google Maps Javascript Part 2" href="/2009/05/absolute-begineers-guide-to-google-maps-javascript-part-2/">subsequent</a> follow up for novices to get a Google Map on a web page it&#8217;s been the most popular post on my site by quite a margin.  Sadly it&#8217;s been resting on its laurels, and is now quite out of date and indeed broken.  So spurred on by my recent server replacement and attempt to revitalise this blog I present the new, improved, and generally working&#8230; Beginners Guide To Google Maps JavaScript v3.</p>
<p>The premise is simple; you&#8217;ve got a requirement to put a map on your site.  You don&#8217;t have the first clue how to do it.  You follow these instructions and you get you map.  Hopefully you&#8217;ll pick up enough to tweak the map to your requirements, if not &#8211; please ask in the comments and I&#8217;ll try and help you.  I&#8217;m assuming that you&#8217;ve got a bit of HTML experience, and that you&#8217;ve got a JavaScript debugger available to you (either Firebug for Firefox or Developer Tools built in to Chrome).</p>
<p>I&#8217;ve based a lot of this on the official Google tutorial here:  <a href="https://developers.google.com/maps/documentation/javascript/tutorial">https://developers.google.com/maps/documentation/javascript/tutorial</a>.  (I&#8217;m pretty sure they borrowed that from me in the first place, so it&#8217;s only fair 😉 ).</p>
<h1>Part 1.  Getting the map on the page</h1>
<p>Get yourself an API key for Google Maps from here:  <a href="https://developers.google.com/maps/documentation/javascript/tutorial#api_key" target="_blank" rel="noopener noreferrer">https://developers.google.com/maps/documentation/javascript/tutorial#api_key</a></p>
<p>Let&#8217;s start from the end and work back to the beginning.  Save this as an HTML document, change the API key, open it in your browser and you&#8217;ll have a map.  I&#8217;ve saved you a bit of time by already centring it on Barrow-in-Furness bus depot.</p>
<p>[js]<br>
&lt;!DOCTYPE html&gt;<br>
&lt;html&gt;<br>
  &lt;head&gt;<br>
&lt;title&gt;My first Google Map&lt;/title&gt;<br>
    &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1.0, user-scalable=no&quot; /&gt;<br>
    &lt;style type=&quot;text/css&quot;&gt;<br>
      html { height: 100% }<br>
      body { height: 100%; margin: 0; padding: 0 }<br>
      #map-canvas { height: 100% }<br>
    &lt;/style&gt;<br>
    &lt;script type=&quot;text/javascript&quot;<br>
      src=&quot;https://maps.googleapis.com/maps/api/js?key=XXXXXXXXXXXXXXXX&amp;sensor=false&quot;&gt;<br>
    &lt;/script&gt;<br>
    &lt;script type=&quot;text/javascript&quot;&gt;<br>
      function initialize() {<br>
      	var myLatLng = new google.maps.LatLng(54.124634, -3.237029)<br>
        var mapOptions = {<br>
          center: myLatLng,<br>
          zoom: 17,<br>
          mapTypeId: google.maps.MapTypeId.SATELLITE<br>
          };</p>
<p>        var map = new google.maps.Map(document.getElementById(&quot;map-canvas&quot;),<br>
            mapOptions);</p>
<p>        var myMarker = new google.maps.Marker({<br>
          position: myLatLng,<br>
          map: map,<br>
          title: &quot;A place on Earth&quot;,<br>
          draggable: true,<br>
          })<br>
        }</p>
<p>      google.maps.event.addDomListener(window, &#8216;load&#8217;, initialize);<br>
    &lt;/script&gt;<br>
  &lt;/head&gt;<br>
  &lt;body&gt;<br>
    &lt;div id=&quot;map-canvas&quot;/&gt;<br>
  &lt;/body&gt;<br>
&lt;/html&gt;<br>
[/js]</p>
<p>Copy and paste that in to a text editor, replace XXXXXXXXXXXXXXXX with your own API key, save it somewhere and the load it up in your browser.  You should see a satellite style map with a marker in the middle. You&#8217;re done.  Simple eh?  Read on learn a bit about how it works, and what you can do to change the appearance.</p>
<h2>Part 1.1 Understanding the basic HTML</h2>
<p>In order to try and guarantee a consistent layout across browsers you need to make sure that your page is rendered in &#8216;Standards Compliant&#8217; mode as opposed to &#8216;Quirks&#8217; mode. To do this you need to specify a DOCTYPE at the top of your HTML file.  We&#8217;re using a very simple &#8220;html&#8221; DOCTYPE which tells the browser that we&#8217;re HTML5.  In HTML4.x there were a plethora of variations &#8211; thankfully we don&#8217;t need to care about them anymore.  HTML5 is the way to go, and so the only DOCTYPE we care about is &#8220;html&#8221;.</p>
<p>We set the title of the page, and then we set some initial viewport settings to help mobile browsers render the page correctly.  This is widely regarded as a good thing, and you can learn more about it from here: <a href="http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/">http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/</a></p>
<p>Skipping over the style and scripts for a moment, we create the main body of the page with a single div element in it.  We give it the id &#8220;map-canvas&#8221;, and then we close off the bottom of the body and mark the end of the HTML.  You won&#8217;t be surprised to read that the div we&#8217;ve just created will be where the map will soon appear.</p>
<h2>Part 1.2 All about style</h2>
<p>In standard HTML5 (remember the DOCTYPE from above) there are a few specifics you need to know about CSS.  If an element specifies a size as a percentage, then that percentage is calculated from the parent objects size.  Imagine you have a nested DIV, called DIV2.  It lives inside DIV1.  Where DIV1 has a fixed size of 500px by 500px, then DIV2 knows that 100% high equals 500px, but what if DIV1 didn&#8217;t have a size specified?  In that case, in standards mode, DIV2 would decide that 100% high equals zero px &#8211; because it doesn&#8217;t know any better.  This has caught people out a few times.  In order to make sure that all our DIVs can inherit a size correctly we set the height of the entire HTML page and the BODY to be 100%.  This is calculated by the browser when the page loads, and then can flow down to the elements within the page correctly.</p>
<p>Once we have the parent elements size set correctly (the page, and the body) we can style our map DIV to be 100% high safe in the knowledge that it has enough information to render and the correct size and not 0 px high.</p>
<h2>Part 1.3 The Meat Section</h2>
<p>Now we&#8217;re going to look at the actual JavaScript and understand what it&#8217;s doing and in which order.</p>
<p>First of all, we have the scripts in the HEAD tag.  The browser will load the head part of the HTML first and your scripts will be loaded before the page is fully rendered.  Any functionality that you make available in your scripts should be available to the rest of the page when it comes to need it.  This is generally the right way to do it.</p>
<p>The first SCRIPT tag takes care of loading the Google Maps code.  We tell the browser that the content of the script is text/javascript and then where to find it.  There are a couple of parameters we pass  in to the script through the URL.  The first one is &#8220;key&#8221; &#8211; this is your simple API key for access Google Maps (see above for details of where to get this key).  The second parameter is &#8220;sensor&#8221;.  This is required and must be &#8220;false&#8221; if you&#8217;re not using a GPS (or similar) to work out where you are.  In our case, we&#8217;re just picking a point on and saying &#8220;centre the map here&#8221; &#8211; so we use false.  If were using a GPS to centre the map on our current location, then this would be &#8220;true&#8221;.</p>
<p>This script gets loaded by the browser and now we can start to make use of the Google Maps JavaScript APIs in the rest of our page.</p>
<p>The second script is a bit more complex, but should be easy to understand:</p>
<p>We create a new function called &#8220;initialize&#8221;.<br>
Inside that function we create an object called myLatLng.  We use the Google provided API google.maps.LatLng() to create an object which can be understood by the rest of the Google Maps API and pass in the co-ordinates of Barrow-in-Furness bus depot.  We use &#8220;var&#8221; to limit that object&#8217;s &#8220;scope&#8221; to within the &#8220;initialize&#8221; function &#8211; that is to say, we won&#8217;t be able to get access to that particular myLatLng from other functions on the page.<br>
Next we create another thing called mapOptions.  The format of this is as per the spec here: <a href="https://developers.google.com/maps/documentation/javascript/reference?hl=en#MapOptions">https://developers.google.com/maps/documentation/javascript/reference?hl=en#MapOptions<br>
</a></p>
<p>There are loads of options, most of which we don&#8217;t need to worry about, so we&#8217;re just setting a few key options:  where the map is centered, how much it is zoomed in, and the type of map we see.  The map types are provided by Google as a set of constants, which are identifiable by being all in upper case.  In our case we&#8217;re using SATELLITE, but we could also use HYBRID, ROADMAP or TERRAIN.</p>
<p>Once we&#8217;ve set up the various mapOptions we create a new var called &#8220;map&#8221; which is an instance of a Map object as provided by the Google APIs.  We pass in to it the id of the HTML object where we want the map to appear, as we created in section 1.2, and we pass in the options var which we just created.  This is enough information for the Google APIs to set up the map as we want it and put it on the page.</p>
<p>The last thing we do in our example is add a marker.  A marker is the indicator which you use to highlight a point on the map.  Google provide a lot of icons and colours for us to use, but the default is the red tear-drop one, so we&#8217;ll stick with that for now.</p>
<p>To create a marker we create a new instance of google.Maps.Marker and set up some of the options as we did for the map itself.  We tell it the position for the marker to appear.  We use the &#8220;myLatLng&#8221; object we created earlier.  You might notice that we are using the myLatLng object twice in our example.  Once as the centre point for the map, and once for the position of the marker.  You can probably deduce from this that the marker will appear in the centre of the map.  We also tell the marker which map it should be added to.  We only have one map on our page, but if we had many this is how you&#8217;d add a marker to the correct map.  We give it a title, which is simply a string and we make it draggable by setting the draggable option to &#8220;true&#8221;.  You can read more about the marker options here: <a href="https://developers.google.com/maps/documentation/javascript/reference?hl=en#MarkerOptions">https://developers.google.com/maps/documentation/javascript/reference?hl=en#MarkerOptions</a></p>
<p>That&#8217;s very nearly it for our first simple map.  The last thing to do is use a DOM listener to trigger the above JavaScript when the page loads, and so make our map and marker appear.</p>
<p>google.maps.event.addDomListener is provided via the Google APIs and we pass in three pieces of information.  window is the object provided by the browser.  The &#8216;load&#8217; event is actually is separate from the &#8220;onload&#8221; event you might have read about.  The load event signifies that the page is fully rendered and any JavaScript which wants to manipulate the DOM can begin work, and that&#8217;s what we want to do.  We want to swap the empty div with the id of &#8220;map&#8221; with the actual map.  So once the page is indeed loaded the command will execute the &#8220;initialize&#8221; function and all the magic will happen.</p>
<p>And that&#8217;s it.  We&#8217;re done.  We&#8217;ve got a map on the page centred at our chosen location, and there is a little marker to show a specific part of the map.</p>
<p>If you compare this to the original <a title="Absolute beginners guide to Google Maps Javascript" href="/2009/05/absolute-beginners-guide-to-google-maps-javascript/">Beginners Guide</a> I think you&#8217;ll say that this new version of the API is even easier to use.  I will try and find time of the next few months to jot down a few notes on doing more interesting things with the map but I hope that this will get you started.</p>
        <div class="clearfix"></div>
          
       
    </section>
            <footer class="entry-footer">
                    <div class="meta">
					<span class="author">Posted by </span><a href="/author/will/" title="Posts by will" rel="author">will</a>                <span class="seporator">/</span>
                <span class="date-post h6">December 17, 2013</span>
                                                                                                                                                                                            <span class="seporator">/</span>
                        <span>Posted in</span>
                        <a href="/category/google-maps/" rel="category tag">Google Maps</a><span>,</span> <a href="/category/javascript/" rel="category tag">Javascript</a><span>,</span> <a href="/category/making-the-world-a-better-place/" rel="category tag">Making the world a better place</a>                                                                </div>
            </footer>
    </article><!-- #post -->                                    <article id="post-425" class="post-in-blog post post-425 type-post status-publish format-standard hentry category-linux category-making-the-world-a-better-place category-tv">
                    <header class="entry-header">
        <h2 class="entry-title">
            <a href="/2012/11/26/device-control-over-hdmi-via-cec-libcec-ftw/" rel="bookmark">Device control over HDMI via CEC.  libcec FTW.</a>
        </h2>
    </header> 
    <section class="entry entry-content">
        <p>Blimey, it&#8217;s been a while.  I&#8217;ve been a bit busy, and let&#8217;s be honest; writing up blog posts always sounds like a good idea, but when you get in to it &#8211; it&#8217;s really hard work.</p>
<p>Anyway &#8211; I finally got round to buying a Pulse-Eight CEC to USB adapter:  <a href="http://www.pulse-eight.com/store/products/104-usb-hdmi-cec-adapter.aspx">http://www.pulse-eight.com/store/products/104-usb-hdmi-cec-adapter.aspx</a></p>
<p>This awesome little box of tricks makes up for the lack of CEC control in the vast majority of HDMI-Out equipped graphics cards.  It&#8217;s the final piece in the jigsaw of a Linux based home entertainment device.  It allows you to talk to the other devices in your HDMI network; your surround sound amplifier and your big screen TV being the best examples (assuming they support CEC of course).</p>
<p>CEC has been around for a long time but for some reason it doesn&#8217;t seem to be widely used, or very well implemented, in most consumer electronics devices.  It&#8217;s a published standard but with OEM manufacturers wanting to differentiate their products and introduce a bit of vendor lock-in, they all call it something different.  The fact is that your Toshiba Regza Link TV will talk to your Sony Bravia Link Amp just fine, for the most part.  There might be a couple of proprietary things which don&#8217;t work, but on, off, volume up, volume down etc will all just work.</p>
<p>Pulse Eight&#8217;s USB to CEC adapter lets your computer get in on the act too, and opens up a whole realm of automatic switching, which really cuts down on the number of remote controls you need and the number of buttons you have to remember the purpose of.</p>
<p>The good folk at Pulse Eight have also made libCEC, an open source library to allow pretty much any software to take advantage of the USB adapter.  <a href="http://libcec.pulse-eight.com/">http://libcec.pulse-eight.com/</a></p>
<p>It comes with C++, C and .NET interfaces, and a CLI utility called cec-client.  XBMC &amp; MythTV already support libCEC and have some neat features baked right in.  It&#8217;s good, but it&#8217;s not exactly what I was looking for &#8211; I want a bit more control.</p>
<p>Now, I don&#8217;t know anything about C++ or C or .NET, so until someone writes some Python bindings, my ticket to this party lies solely with the CLI utility cec-client.  It can do most things on the &#8220;transmit&#8221; side, so you can send commands to your other CEC devices fairly easily.  Acting on a request, or listening to the CEC traffic is a bit more complex &#8211; but not beyond the realms of possibility.</p>
<p>This weekend I wrote (and rewrote and rewrote) a couple of Bash scripts to:</p>
<ul>
<li>Let me control the system volume (i.e. the real hardware, not the mixer on the computer) on the TV &amp; Amp from the PCs remote control</li>
<li>Let me switch the TV &amp; Amp on and off</li>
<li>Activate proper muting, again not the mixer on the computer &#8211; the hardware itself</li>
<li>Switch the amp &amp; TV to my MythTV PC</li>
<li>Power off all the hardware when the PC suspends, and then switching it all back on again</li>
<li>Shut the whole lot down when the screensaver on the PC kicks in.</li>
</ul>
<p style="text-align: left;">I make these scripts available for your amusement:</p>
<div>
<ul>
<li><a href="/wp-content/uploads/2012/11/cecserver.sh_.txt">cecserver.sh</a></li>
<li><a href="/wp-content/uploads/2012/11/cecsimple.sh_.txt">cecsimple.sh</a></li>
</ul>
</div>
<p>cecsimple is a client of the &#8220;server&#8221; which itself is a client of cec-client.  Fire up the server and then issue it commands down the FIFO either directly or via the abstraction layer which is cecsimple.sh.</p>
<p>&nbsp;</p>
<p>I hooked up the volume control and amp power via &#8220;irexec&#8221; and lirc.  I tell irexec to execute, for example, &#8220;cecsimple.sh volup&#8221; or &#8220;cecsimple.sh ampon&#8221;.  If the server component is already running then these commands are sent very quickly and you don&#8217;t really notice the lag.</p>
<p>To switch the TV off when the PC goes in to suspend mode I added a script in /etc/pm/sleep.d which calls &#8220;cecsimple.sh tvoff&#8221; and then &#8220;cecsimple.sh tvon&#8221; when it resumes.  In theory if the TV is using the Amp to output surround sound audio then the TV will tell the Amp to turn off, it it&#8217;s not &#8211; it wont.</p>
<p>To switch things off when the screensaver kicks in, I simply &#8220;sudo pm-suspend&#8221; from an &#8220;xscreensaver-command -watch&#8221; script.</p>
<p>&nbsp;</p>
<p>The practical upshot is that I can now control 99% of my media centre from a single remote control.  I&#8217;ve opted to use the remote connected to the PC as I found it to be the least laggy &#8211; using the TV remote to send up/down/left/right etc to the PC was sluggish.</p>
<p>&nbsp;</p>
<p>I think it should be possible to parse the log output from cec-client and write a &#8220;listener&#8221; component too, but it&#8217;s probably a better idea to learn some rudimentary C and do it properly.  Or some Python bindings.  Oh yeah, and you know what would be really cool, a hook in to MythTV so that when I&#8217;m watching something in surround sound the amp turns on automatically. That would be cool.</p>
<p>&nbsp;</p>
<p>UPDATE 3 Dec 2013:  When someone leaves the amp&#8217;s HDMI switch set on the PS3 and you switch the MythTV box on from the remote, the amp doesn&#8217;t automatically switch to MythTV.  This has been annoying me for a while now, so I fixed it.</p>
<p>In the scripts linked to above the &#8220;active source&#8221; command does this:</p>
<pre>send_command "tx 45 82 11 00"</pre>
<p>4 (the MythTV device) to 5 (the amp) &#8211; 82 (switch active source) to 1.1.0.0 &#8211; but my Sony amp just ignores this request.</p>
<p>I spent some time trying out a few alternatives with cec-client and I&#8217;ve found one which works, and it kinda makes sense why:</p>
<pre>send_command "tx 45 70 11 00"</pre>
<p>4 (MythTV) to 5 (Sony amp) 70 (System Audio Mode) 1.1.0.0 (the input where MythTV is connected)</p>
<p>My assumption is that amp only speaks &#8220;system audio&#8221; &#8211; what with it being an amp.  I&#8217;ve changed the &#8220;activesrc&#8221; with the 45:70:11:00 code and now it works!  (It also switches the amp on, whether I like it or not &#8211; so it&#8217;s not perfect).</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Useful links:</p>
<ul>
<li><a href="http://www.cec-o-matic.com/">http://www.cec-o-matic.com/</a></li>
<li><a href="http://www.jwz.org/xscreensaver/man3.html">http://www.jwz.org/xscreensaver/man3.html</a></li>
<li><a href="https://github.com/Pulse-Eight/libcec">https://github.com/Pulse-Eight/libcec</a></li>
</ul>
<p>&nbsp;</p>
        <div class="clearfix"></div>
          
       
    </section>
            <footer class="entry-footer">
                    <div class="meta">
					<span class="author">Posted by </span><a href="/author/will/" title="Posts by will" rel="author">will</a>                <span class="seporator">/</span>
                <span class="date-post h6">November 26, 2012</span>
                                                                                                                                                                                            <span class="seporator">/</span>
                        <span>Posted in</span>
                        <a href="/category/linux/" rel="category tag">linux</a><span>,</span> <a href="/category/making-the-world-a-better-place/" rel="category tag">Making the world a better place</a><span>,</span> <a href="/category/tv/" rel="category tag">tv</a>                                                                </div>
            </footer>
    </article><!-- #post -->                                    <article id="post-403" class="post-in-blog post post-403 type-post status-publish format-standard hentry category-making-the-world-a-better-place">
                    <header class="entry-header">
        <h2 class="entry-title">
            <a href="/2012/08/04/monetizing-my-feeds/" rel="bookmark">Monetizing my feeds</a>
        </h2>
    </header> 
    <section class="entry entry-content">
        <p>I decided I wanted to add adverts to my RSS feed. Hardly anyone subscribes to this blog, a dozen people or so (Hello! I bet I know exactly who you all are), but I do get a few hundred hits a month on my <a title="Absolute beginners guide to Google Maps Javascript" href="/2009/05/absolute-beginners-guide-to-google-maps-javascript/">Beginners Guide To Google Maps tutorial</a>. So adding adverts to the feed shouldn&#8217;t really hurt anyone, and as a bonus the bandwidth used serving the RSS feed should reduce.</p>
<p>AdSense lets you easily monetize a feed by sucking in an RSS feed, and this is <a style="text-decoration: none;" href="http://www.phonetipsandtricks.com/increase-adsense-earnings/"><span style="text-decoration: none; color: #3d3d3d;">how to increase your Adsense earnings</span></a>, parsing it and adding the advert code and then spitting it back out again via FeedBurner.  You can do this by logging in to your AdSense account, click &#8220;My Ads&#8221; and then expand the &#8220;Feeds&#8221; section on the left. Once you&#8217;ve filled in the boxes, it&#8217;ll provide you with a new URL for your feed complete with adverts.</p>
<p>All this is pretty easy, but then comes the question of how you get people to see the new monetized feed?</p>
<p>First things first, FeedBurner can generate a little bit of HTML for you to add to your WordPress Sidebar. It&#8217;s described here<a href="http://support.google.com/feedburner/answer/78487/?hl=en&amp;"> http://support.google.com/feedburner/answer/78487/?hl=en&amp;</a> and for the sake of completeness also described here:</p>
<ol>
<li>Log in to FeedBurner using the same credentials as you log in to AdSense</li>
<li>Click on <strong>Publicize</strong> from the menus near the top of the page</li>
<li>Click on <strong>Chicklet Chooser</strong>
</li>
<li>Choose the type of button you&#8217;d like to appear on you blog. Personally I think the smaller &#8220;Subscribe in a reader&#8221; is the best choice</li>
<li>Then the Javascript at the button of the page is automatically updated, so copy it to the clipboard (ctrl-c)</li>
<li>Go to the Admin page of your WordPress blog</li>
<li>Choose <strong>Appearance</strong>
</li>
<li>Choose <strong>Widgets</strong>
</li>
<li>Drag &#8220;<strong>Text: Arbitrary text for HTML</strong>&#8221; to your sidebar</li>
<li>Drop down the Sidebar widget and paste the text from above in to the big box</li>
<li>Click <strong>Save</strong> and click <strong>close</strong>
</li>
<li>You&#8217;re done!</li>
</ol>
<p>That was the easy bit. Now new subscribers to your blog feed can simply click the button and will be taken to the new monetized feed.</p>
<p>But what about existing subscribers? Or 3rd party links which point direct at your &#8220;/feed/&#8221; URL? There&#8217;s the rub.</p>
<p>What you need to do is redirect them to the new URL, but then if you put a <em>global</em> redirect from the old URL to the new URL, how is FeedBurner going to keep itself updated? (It&#8217;ll get redirected back to itself and so never see any of your new posts)</p>
<p>The trick is to use <strong>mod_rewrite</strong> and check for the <strong>HTTP_USER_AGENT</strong> of &#8220;FeedBurner&#8221;.</p>
<p>I&#8217;m going to assume that you&#8217;ve already got mod_rewrite enabled in your Apache config. If you&#8217;re running WordPress on your own server then you most likely have it enabled without even realising.</p>
<p>In your blog&#8217;s web directory you will find a &#8220;<strong>.htaccess</strong>&#8221; file, open this up and you&#8217;ll probably see something like this:</p>
<pre># BEGIN WordPress
 RewriteEngine On
 RewriteBase /
 RewriteRule ^index.php$ - [L]
 RewriteCond %{REQUEST_FILENAME} !-f
 RewriteCond %{REQUEST_FILENAME} !-d
 RewriteRule . /index.php [L]</pre>
<p>What you need to do is add these lines between &#8220;<strong>RewriteBase /</strong>&#8221; and &#8220;<strong>RewriteRule ^index.php$ &#8211; [L]</strong>&#8221;</p>
<pre>RewriteCond %{REQUEST_URI} ^/feed/* [NC]
 RewriteCond %{HTTP_USER_AGENT} !FeedBurner
 RewriteRule ^feed/?.*$ http://feeds.feedburner.com/Whizzyorg [R,L]
 #Next rule</pre>
<p>How does it work?</p>
<p>Mod_rewrite matches all the conditions in order, when it hits a Rule it decides if all the preceding conditions are met, and if so acts on the rule. If not, if moves on to the next line. The rules are the the separators between the conditions.</p>
<p>So the new logic says:</p>
<ul>
<li>
<span style="text-decoration: underline;">IF</span> you&#8217;re trying to get to &#8220;<strong>/feed/</strong>&#8221; (the [NC] makes it case insensitive)</li>
<li>
<span style="text-decoration: underline;">AND</span> your <strong>USER_AGENT</strong> is <em>NOT</em> &#8220;FeedBurner&#8221; (the ! inverts the logic)</li>
<li>
<span style="text-decoration: underline;">THEN</span> re-direct people to the new URL</li>
</ul>
<p>So, if you are FeedBurner you get access to the old standard WordPress RSS feed and keep yourself updated, if you&#8217;re anyone else you get redirected and see the adverts.</p>
<p>The adverts are fairly inconspicuous and are easily blocked by those in the know, so I don&#8217;t have a problem with it.</p>
<p>Neat!</p>
        <div class="clearfix"></div>
          
       
    </section>
            <footer class="entry-footer">
                    <div class="meta">
					<span class="author">Posted by </span><a href="/author/will/" title="Posts by will" rel="author">will</a>                <span class="seporator">/</span>
                <span class="date-post h6">August 4, 2012</span>
                                                                                                                                                                                            <span class="seporator">/</span>
                        <span>Posted in</span>
                        <a href="/category/making-the-world-a-better-place/" rel="category tag">Making the world a better place</a>                                                                </div>
            </footer>
    </article><!-- #post -->                                                <nav class="navigation paging-navigation">
                    <a class="prev page-numbers" href="/category/making-the-world-a-better-place/page/4/">&laquo; Previous</a>
<a class="page-numbers" href="/category/making-the-world-a-better-place/">1</a>
<span class="page-numbers dots">&hellip;</span>
<a class="page-numbers" href="/category/making-the-world-a-better-place/page/3/">3</a>
<a class="page-numbers" href="/category/making-the-world-a-better-place/page/4/">4</a>
<span aria-current="page" class="page-numbers current">5</span>
<a class="page-numbers" href="/category/making-the-world-a-better-place/page/6/">6</a>
<a class="page-numbers" href="/category/making-the-world-a-better-place/page/7/">7</a>
<a class="next page-numbers" href="/category/making-the-world-a-better-place/page/6/">Next &raquo;</a>                </nav><!-- .navigation -->

            
        </div>
        <div class=" col-xs-12 col-sm-12 col-md-4 col-lg-4">
            <aside id="sidebar">
    <div class="widget-area">
                    <div id="archives-4" class="widget widget_archive">
<h3 class="widget-title">Archives</h3>
			<ul>
					<li><a href="/2021/07/">July 2021</a></li>
	<li><a href="/2021/01/">January 2021</a></li>
	<li><a href="/2019/07/">July 2019</a></li>
	<li><a href="/2019/06/">June 2019</a></li>
	<li><a href="/2019/05/">May 2019</a></li>
	<li><a href="/2017/05/">May 2017</a></li>
	<li><a href="/2017/03/">March 2017</a></li>
	<li><a href="/2017/02/">February 2017</a></li>
	<li><a href="/2016/12/">December 2016</a></li>
	<li><a href="/2016/11/">November 2016</a></li>
	<li><a href="/2016/10/">October 2016</a></li>
	<li><a href="/2016/09/">September 2016</a></li>
	<li><a href="/2016/02/">February 2016</a></li>
	<li><a href="/2015/12/">December 2015</a></li>
	<li><a href="/2015/10/">October 2015</a></li>
	<li><a href="/2015/09/">September 2015</a></li>
	<li><a href="/2015/06/">June 2015</a></li>
	<li><a href="/2015/05/">May 2015</a></li>
	<li><a href="/2015/02/">February 2015</a></li>
	<li><a href="/2014/08/">August 2014</a></li>
	<li><a href="/2014/02/">February 2014</a></li>
	<li><a href="/2014/01/">January 2014</a></li>
	<li><a href="/2013/12/">December 2013</a></li>
	<li><a href="/2013/11/">November 2013</a></li>
	<li><a href="/2013/02/">February 2013</a></li>
	<li><a href="/2012/11/">November 2012</a></li>
	<li><a href="/2012/08/">August 2012</a></li>
	<li><a href="/2012/03/">March 2012</a></li>
	<li><a href="/2011/09/">September 2011</a></li>
	<li><a href="/2011/08/">August 2011</a></li>
	<li><a href="/2011/07/">July 2011</a></li>
	<li><a href="/2011/06/">June 2011</a></li>
	<li><a href="/2011/04/">April 2011</a></li>
	<li><a href="/2011/02/">February 2011</a></li>
	<li><a href="/2010/10/">October 2010</a></li>
	<li><a href="/2010/09/">September 2010</a></li>
	<li><a href="/2010/08/">August 2010</a></li>
	<li><a href="/2010/06/">June 2010</a></li>
	<li><a href="/2010/01/">January 2010</a></li>
	<li><a href="/2009/10/">October 2009</a></li>
	<li><a href="/2009/09/">September 2009</a></li>
	<li><a href="/2009/08/">August 2009</a></li>
	<li><a href="/2009/07/">July 2009</a></li>
	<li><a href="/2009/06/">June 2009</a></li>
	<li><a href="/2009/05/">May 2009</a></li>
			</ul>

			</div>
		<div id="recent-posts-2" class="widget widget_recent_entries">
		<h3 class="widget-title">Recent Posts</h3>
		<ul>
											<li>
					<a href="/2021/07/14/finally-moving-to-a-static-site/">Finally moving to a static site</a>
									</li>
											<li>
					<a href="/2021/01/02/double-helping-of-pi-hole/">Double helping of Pi Hole</a>
									</li>
											<li>
					<a href="/2019/07/16/dns-over-https-in-a-snap/">DNS over HTTPS in a snap</a>
									</li>
											<li>
					<a href="/2019/06/11/whizzy-labs-wireless-sensor/">Whizzy Labs Wireless Sensor</a>
									</li>
											<li>
					<a href="/2019/05/07/ubuntu-developer-desktop-survey-2019/">Ubuntu Developer Desktop Survey 2019</a>
									</li>
					</ul>

		</div>
<div id="categories-4" class="widget widget_categories">
<h3 class="widget-title">Categories</h3>
			<ul>
					<li class="cat-item cat-item-2">
<a href="/category/alexa/">Alexa</a>
</li>
	<li class="cat-item cat-item-3">
<a href="/category/arduino/">Arduino</a>
</li>
	<li class="cat-item cat-item-4">
<a href="/category/asterisk/">asterisk</a>
</li>
	<li class="cat-item cat-item-5">
<a href="/category/google-maps/">Google Maps</a>
</li>
	<li class="cat-item cat-item-6">
<a href="/category/iot/">IoT</a>
</li>
	<li class="cat-item cat-item-7">
<a href="/category/javascript/">Javascript</a>
</li>
	<li class="cat-item cat-item-8">
<a href="/category/linux/">linux</a>
</li>
	<li class="cat-item cat-item-9 current-cat">
<a aria-current="page" href="/category/making-the-world-a-better-place/">Making the world a better place</a>
</li>
	<li class="cat-item cat-item-10">
<a href="/category/raspberrypi/">RaspberryPi</a>
</li>
	<li class="cat-item cat-item-12">
<a href="/category/so-called-humor/">So called humor</a>
</li>
	<li class="cat-item cat-item-13">
<a href="/category/tv/">tv</a>
</li>
	<li class="cat-item cat-item-14">
<a href="/category/ubuntu-2/">Ubuntu</a>
</li>
	<li class="cat-item cat-item-15">
<a href="/category/uncategorized/">Uncategorized</a>
</li>
			</ul>

			</div>            </div>
<!-- .widget-area -->
</aside>
        </div>
    </div>
</div>

</div>
<!-- #main -->
	<footer id="footer" class="site-footer">
		<a href="#" id="toTop" class="toTop"><i class="fa fa-angle-up"></i></a>
		<div class="footer-sidebar">
    <div class="container">
        <div class="row">            
                        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                            </div>
            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                            </div>
            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                            </div>
        </div>
<!-- .widget-area -->
    </div>
</div>		<div class="footer-inner">
			<div class="container">
								<p class="social-profile type1 pull-right">
																<a href="https://twitter.com/8none1" class="button-twitter" title="Twitter" target="_blank"><i class="fa fa-twitter-square"></i></a>
																					<a href="https://github.com/8none1" class="button-google" title="Google +" target="_blank"><i class="fa fa-google-plus-square"></i></a>
																															<a href="https://www.youtube.com/user/willcooke1" class="button-youtube" title="Youtube" target="_blank"><i class="fa fa-youtube-square"></i></a>
															                    
				</p>
				<p class="copyright"><span class="copyright-date">
						&copy; Copyright 2021                    </span>
										  <a href="/" title="whizzy.org" target="_blank">whizzy.org</a>
					  &#8226; Designed by <a href="https://motopress.com/" rel="nofollow" title="Premium WordPress Plugins and Themes">MotoPress</a>
					  &#8226; Proudly Powered by <a href="http://wordpress.org/" rel="nofollow" title="Semantic Personal Publishing Platform">WordPress</a>
					  				</p>
<!-- .copyright -->
			</div>
		</div>
	</footer>
</div>
<script type="text/javascript" src="/wp-includes/js/hoverIntent.min.js?ver=1.8.1" id="hoverIntent-js"></script>
<script type="text/javascript" src="/wp-content/themes/emmet-lite/js/superfish.min.js?ver=1.7.5" id="superfish.min-js"></script>
<script type="text/javascript" src="/wp-content/themes/emmet-lite/js/jquery.flexslider-min.js?ver=2.5.0" id="flexslider-js"></script>
<script type="text/javascript" src="/wp-content/themes/emmet-lite/js/jquery.appear.min.js?ver=0.3.6" id="jquery.appear-js"></script>
<script type="text/javascript" id="emmet-script-js-extra">
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
var template_directory_uri = {"url":"\/wp-content\/themes\/emmet-lite"};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/themes/emmet-lite/js/emmet.min.js?ver=1.7.5" id="emmet-script-js"></script>
<script type="text/javascript" src="/wp-includes/js/wp-embed.min.js?ver=5.7.2" id="wp-embed-js"></script>
    <script>
        /(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
    </script>
	</body>
</html>